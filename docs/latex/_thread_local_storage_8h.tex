\doxysection{dev/kernel/\+Kernel\+Kit/\+Thread\+Local\+Storage.h File Reference}
\hypertarget{_thread_local_storage_8h}{}\label{_thread_local_storage_8h}\index{dev/kernel/KernelKit/ThreadLocalStorage.h@{dev/kernel/KernelKit/ThreadLocalStorage.h}}
{\ttfamily \#include $<$New\+Kit/\+Defines.\+h$>$}\newline
{\ttfamily \#include $<$New\+Kit/\+Error\+Or.\+h$>$}\newline
{\ttfamily \#include $<$Kernel\+Kit/\+Thread\+Local\+Storage.\+inl$>$}\newline
\doxysubsubsection*{Classes}
\begin{DoxyCompactItemize}
\item 
struct \mbox{\hyperlink{struct_t_h_r_e_a_d___i_n_f_o_r_m_a_t_i_o_n___b_l_o_c_k}{THREAD\+\_\+\+INFORMATION\+\_\+\+BLOCK}}
\begin{DoxyCompactList}\small\item\em Thread Information Block. Located in GS on AMD64, other architectures have their own stuff. (64x0, 32x0, ARM64) \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \mbox{\hyperlink{_thread_local_storage_8h_a39683a608eefc16d880899385c042408}{k\+Cookie\+Mag0\+Idx}}~0
\begin{DoxyCompactList}\small\item\em ! \end{DoxyCompactList}\item 
\#define \mbox{\hyperlink{_thread_local_storage_8h_ab1357a121e283459f40f1118dfa9d395}{k\+Cookie\+Mag1\+Idx}}~1
\item 
\#define \mbox{\hyperlink{_thread_local_storage_8h_a5d55858d4f22bdb9c35fdeb1c0ca88c8}{k\+Cookie\+Mag2\+Idx}}~2
\item 
\#define \mbox{\hyperlink{_thread_local_storage_8h_a691735124fe4874a00321892fa18eab2}{k\+Cookie\+Mag0}}~\textquotesingle{}Z\textquotesingle{}
\item 
\#define \mbox{\hyperlink{_thread_local_storage_8h_af76285bfd27e7d36a384f13604debcbb}{k\+Cookie\+Mag1}}~\textquotesingle{}K\textquotesingle{}
\item 
\#define \mbox{\hyperlink{_thread_local_storage_8h_aaa7f99f2086a60125a41be9ee290c1d4}{k\+Cookie\+Mag2}}~\textquotesingle{}A\textquotesingle{}
\item 
\#define \mbox{\hyperlink{_thread_local_storage_8h_a3254ac69ed0c1cc604149addb63c3402}{k\+TLSCookie\+Len}}~(3U)
\end{DoxyCompactItemize}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{namespace_ne_o_s_a3245bb65efabbdafe2c6b73041d782e0}{Ne\+OS\+::\+Boolean}} \mbox{\hyperlink{_thread_local_storage_8h_acbf6340182913c60a98a6ffd18175d02}{tls\+\_\+check\+\_\+tib}} (\mbox{\hyperlink{struct_t_h_r_e_a_d___i_n_f_o_r_m_a_t_i_o_n___b_l_o_c_k}{THREAD\+\_\+\+INFORMATION\+\_\+\+BLOCK}} \texorpdfstring{$\ast$}{*}the\+\_\+tib)
\begin{DoxyCompactList}\small\item\em ! \end{DoxyCompactList}\item 
{\footnotesize template$<$typename T $>$ }\\T \texorpdfstring{$\ast$}{*} \mbox{\hyperlink{_thread_local_storage_8h_a3e273becb8719d0ad0de7253b51dd2be}{tls\+\_\+new\+\_\+ptr}} (void) noexcept
\begin{DoxyCompactList}\small\item\em ! \end{DoxyCompactList}\item 
{\footnotesize template$<$typename T $>$ }\\\mbox{\hyperlink{namespace_ne_o_s_a3245bb65efabbdafe2c6b73041d782e0}{Ne\+OS\+::\+Boolean}} \mbox{\hyperlink{_thread_local_storage_8h_ab385bd8ac0de475e955abe3aafe222f8}{tls\+\_\+delete\+\_\+ptr}} (T \texorpdfstring{$\ast$}{*}ptr) noexcept
\begin{DoxyCompactList}\small\item\em ! \end{DoxyCompactList}\item 
{\footnotesize template$<$typename T $>$ }\\\mbox{\hyperlink{namespace_ne_o_s_ad5f3c5e87966b36f6741ac5897f80120}{Ne\+OS\+::\+Bool}} \mbox{\hyperlink{_thread_local_storage_8h_a6f08739957d1e7e2d02535186da2b378}{tls\+\_\+delete\+\_\+ptr}} (\mbox{\hyperlink{class_ne_o_s_1_1_error_or}{Ne\+OS\+::\+Error\+Or}}$<$ T $>$ obj) noexcept
\begin{DoxyCompactList}\small\item\em Delete process pointer. \end{DoxyCompactList}\item 
{\footnotesize template$<$typename T $>$ }\\\mbox{\hyperlink{namespace_ne_o_s_ad5f3c5e87966b36f6741ac5897f80120}{Ne\+OS\+::\+Bool}} \mbox{\hyperlink{_thread_local_storage_8h_aa3ef907fcf7b76f131f51e0de02100f6}{tls\+\_\+delete\+\_\+ptr}} (\mbox{\hyperlink{class_ne_o_s_1_1_error_or}{Ne\+OS\+::\+Error\+Or}}$<$ T \texorpdfstring{$\ast$}{*} $>$ obj) noexcept
\begin{DoxyCompactList}\small\item\em Delete process pointer. \end{DoxyCompactList}\item 
{\footnotesize template$<$typename T , typename... Args$>$ }\\T \texorpdfstring{$\ast$}{*} \mbox{\hyperlink{_thread_local_storage_8h_aeb447845d0d9eee77a67d2bd3bd4d86f}{tls\+\_\+new\+\_\+class}} (Args \&\&... args)
\begin{DoxyCompactList}\small\item\em Allocate a C++ class, and then call the constructor of it. \end{DoxyCompactList}\item 
\mbox{\hyperlink{kernel_2_new_kit_2_macros_8h_abbaccfbed35b945162c27ef6d3748e77}{EXTERN\+\_\+C}} \mbox{\hyperlink{namespace_ne_o_s_ad33956dfc567efebd063d7bc6d1ae82d}{Ne\+OS\+::\+Void}} \mbox{\hyperlink{_thread_local_storage_8h_a34d263f62015b78514dc82b05dd9e04f}{rt\+\_\+install\+\_\+tib}} (\mbox{\hyperlink{struct_t_h_r_e_a_d___i_n_f_o_r_m_a_t_i_o_n___b_l_o_c_k}{THREAD\+\_\+\+INFORMATION\+\_\+\+BLOCK}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{kernel_2_new_kit_2_macros_8h_a8d236eda4577d4fc3bf28ffc5e36b5ca}{TIB}}, \mbox{\hyperlink{struct_t_h_r_e_a_d___i_n_f_o_r_m_a_t_i_o_n___b_l_o_c_k}{THREAD\+\_\+\+INFORMATION\+\_\+\+BLOCK}} \texorpdfstring{$\ast$}{*}PIB)
\begin{DoxyCompactList}\small\item\em TLS install TIB and PIB. (syscall) \end{DoxyCompactList}\item 
\mbox{\hyperlink{kernel_2_new_kit_2_macros_8h_abbaccfbed35b945162c27ef6d3748e77}{EXTERN\+\_\+C}} \mbox{\hyperlink{namespace_ne_o_s_ad5f3c5e87966b36f6741ac5897f80120}{Ne\+OS\+::\+Bool}} \mbox{\hyperlink{_thread_local_storage_8h_a744f001ded3bc48a964f201dcf7170f8}{tls\+\_\+check\+\_\+syscall\+\_\+impl}} (\mbox{\hyperlink{namespace_ne_o_s_ac1c63bbbae84b587c92428c1f2025036}{Ne\+OS\+::\+Void\+Ptr}} \mbox{\hyperlink{kernel_2_new_kit_2_macros_8h_a8d236eda4577d4fc3bf28ffc5e36b5ca}{TIB}}) noexcept
\begin{DoxyCompactList}\small\item\em TLS check (syscall) \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Macro Definition Documentation}
\Hypertarget{_thread_local_storage_8h_a691735124fe4874a00321892fa18eab2}\label{_thread_local_storage_8h_a691735124fe4874a00321892fa18eab2} 
\index{ThreadLocalStorage.h@{ThreadLocalStorage.h}!kCookieMag0@{kCookieMag0}}
\index{kCookieMag0@{kCookieMag0}!ThreadLocalStorage.h@{ThreadLocalStorage.h}}
\doxysubsubsection{\texorpdfstring{kCookieMag0}{kCookieMag0}}
{\footnotesize\ttfamily \#define k\+Cookie\+Mag0~\textquotesingle{}Z\textquotesingle{}}

\Hypertarget{_thread_local_storage_8h_a39683a608eefc16d880899385c042408}\label{_thread_local_storage_8h_a39683a608eefc16d880899385c042408} 
\index{ThreadLocalStorage.h@{ThreadLocalStorage.h}!kCookieMag0Idx@{kCookieMag0Idx}}
\index{kCookieMag0Idx@{kCookieMag0Idx}!ThreadLocalStorage.h@{ThreadLocalStorage.h}}
\doxysubsubsection{\texorpdfstring{kCookieMag0Idx}{kCookieMag0Idx}}
{\footnotesize\ttfamily \#define k\+Cookie\+Mag0\+Idx~0}



! 

Thread Local Storage for neoskrnl. \Hypertarget{_thread_local_storage_8h_af76285bfd27e7d36a384f13604debcbb}\label{_thread_local_storage_8h_af76285bfd27e7d36a384f13604debcbb} 
\index{ThreadLocalStorage.h@{ThreadLocalStorage.h}!kCookieMag1@{kCookieMag1}}
\index{kCookieMag1@{kCookieMag1}!ThreadLocalStorage.h@{ThreadLocalStorage.h}}
\doxysubsubsection{\texorpdfstring{kCookieMag1}{kCookieMag1}}
{\footnotesize\ttfamily \#define k\+Cookie\+Mag1~\textquotesingle{}K\textquotesingle{}}

\Hypertarget{_thread_local_storage_8h_ab1357a121e283459f40f1118dfa9d395}\label{_thread_local_storage_8h_ab1357a121e283459f40f1118dfa9d395} 
\index{ThreadLocalStorage.h@{ThreadLocalStorage.h}!kCookieMag1Idx@{kCookieMag1Idx}}
\index{kCookieMag1Idx@{kCookieMag1Idx}!ThreadLocalStorage.h@{ThreadLocalStorage.h}}
\doxysubsubsection{\texorpdfstring{kCookieMag1Idx}{kCookieMag1Idx}}
{\footnotesize\ttfamily \#define k\+Cookie\+Mag1\+Idx~1}

\Hypertarget{_thread_local_storage_8h_aaa7f99f2086a60125a41be9ee290c1d4}\label{_thread_local_storage_8h_aaa7f99f2086a60125a41be9ee290c1d4} 
\index{ThreadLocalStorage.h@{ThreadLocalStorage.h}!kCookieMag2@{kCookieMag2}}
\index{kCookieMag2@{kCookieMag2}!ThreadLocalStorage.h@{ThreadLocalStorage.h}}
\doxysubsubsection{\texorpdfstring{kCookieMag2}{kCookieMag2}}
{\footnotesize\ttfamily \#define k\+Cookie\+Mag2~\textquotesingle{}A\textquotesingle{}}

\Hypertarget{_thread_local_storage_8h_a5d55858d4f22bdb9c35fdeb1c0ca88c8}\label{_thread_local_storage_8h_a5d55858d4f22bdb9c35fdeb1c0ca88c8} 
\index{ThreadLocalStorage.h@{ThreadLocalStorage.h}!kCookieMag2Idx@{kCookieMag2Idx}}
\index{kCookieMag2Idx@{kCookieMag2Idx}!ThreadLocalStorage.h@{ThreadLocalStorage.h}}
\doxysubsubsection{\texorpdfstring{kCookieMag2Idx}{kCookieMag2Idx}}
{\footnotesize\ttfamily \#define k\+Cookie\+Mag2\+Idx~2}

\Hypertarget{_thread_local_storage_8h_a3254ac69ed0c1cc604149addb63c3402}\label{_thread_local_storage_8h_a3254ac69ed0c1cc604149addb63c3402} 
\index{ThreadLocalStorage.h@{ThreadLocalStorage.h}!kTLSCookieLen@{kTLSCookieLen}}
\index{kTLSCookieLen@{kTLSCookieLen}!ThreadLocalStorage.h@{ThreadLocalStorage.h}}
\doxysubsubsection{\texorpdfstring{kTLSCookieLen}{kTLSCookieLen}}
{\footnotesize\ttfamily \#define k\+TLSCookie\+Len~(3U)}



\doxysubsection{Function Documentation}
\Hypertarget{_thread_local_storage_8h_a34d263f62015b78514dc82b05dd9e04f}\label{_thread_local_storage_8h_a34d263f62015b78514dc82b05dd9e04f} 
\index{ThreadLocalStorage.h@{ThreadLocalStorage.h}!rt\_install\_tib@{rt\_install\_tib}}
\index{rt\_install\_tib@{rt\_install\_tib}!ThreadLocalStorage.h@{ThreadLocalStorage.h}}
\doxysubsubsection{\texorpdfstring{rt\_install\_tib()}{rt\_install\_tib()}}
{\footnotesize\ttfamily \mbox{\hyperlink{kernel_2_new_kit_2_macros_8h_abbaccfbed35b945162c27ef6d3748e77}{EXTERN\+\_\+C}} \mbox{\hyperlink{namespace_ne_o_s_ad33956dfc567efebd063d7bc6d1ae82d}{Ne\+OS\+::\+Void}} rt\+\_\+install\+\_\+tib (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{struct_t_h_r_e_a_d___i_n_f_o_r_m_a_t_i_o_n___b_l_o_c_k}{THREAD\+\_\+\+INFORMATION\+\_\+\+BLOCK}} \texorpdfstring{$\ast$}{*}}]{TIB,  }\item[{\mbox{\hyperlink{struct_t_h_r_e_a_d___i_n_f_o_r_m_a_t_i_o_n___b_l_o_c_k}{THREAD\+\_\+\+INFORMATION\+\_\+\+BLOCK}} \texorpdfstring{$\ast$}{*}}]{PIB }\end{DoxyParamCaption})}



TLS install TIB and PIB. (syscall) 

\Hypertarget{_thread_local_storage_8h_a744f001ded3bc48a964f201dcf7170f8}\label{_thread_local_storage_8h_a744f001ded3bc48a964f201dcf7170f8} 
\index{ThreadLocalStorage.h@{ThreadLocalStorage.h}!tls\_check\_syscall\_impl@{tls\_check\_syscall\_impl}}
\index{tls\_check\_syscall\_impl@{tls\_check\_syscall\_impl}!ThreadLocalStorage.h@{ThreadLocalStorage.h}}
\doxysubsubsection{\texorpdfstring{tls\_check\_syscall\_impl()}{tls\_check\_syscall\_impl()}}
{\footnotesize\ttfamily \mbox{\hyperlink{kernel_2_new_kit_2_macros_8h_abbaccfbed35b945162c27ef6d3748e77}{EXTERN\+\_\+C}} \mbox{\hyperlink{namespace_ne_o_s_ad5f3c5e87966b36f6741ac5897f80120}{Ne\+OS\+::\+Bool}} tls\+\_\+check\+\_\+syscall\+\_\+impl (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{namespace_ne_o_s_ac1c63bbbae84b587c92428c1f2025036}{Ne\+OS\+::\+Void\+Ptr}}}]{tib\+\_\+ptr }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [noexcept]}}



TLS check (syscall) 

TLS check (syscall)


\begin{DoxyParams}{Parameters}
{\em tib\+\_\+ptr} & The TIB record. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
if the TIB record is valid or not. 
\end{DoxyReturn}
\Hypertarget{_thread_local_storage_8h_acbf6340182913c60a98a6ffd18175d02}\label{_thread_local_storage_8h_acbf6340182913c60a98a6ffd18175d02} 
\index{ThreadLocalStorage.h@{ThreadLocalStorage.h}!tls\_check\_tib@{tls\_check\_tib}}
\index{tls\_check\_tib@{tls\_check\_tib}!ThreadLocalStorage.h@{ThreadLocalStorage.h}}
\doxysubsubsection{\texorpdfstring{tls\_check\_tib()}{tls\_check\_tib()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespace_ne_o_s_a3245bb65efabbdafe2c6b73041d782e0}{Ne\+OS\+::\+Boolean}} tls\+\_\+check\+\_\+tib (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{struct_t_h_r_e_a_d___i_n_f_o_r_m_a_t_i_o_n___b_l_o_c_k}{THREAD\+\_\+\+INFORMATION\+\_\+\+BLOCK}} \texorpdfstring{$\ast$}{*}}]{tib\+\_\+ptr }\end{DoxyParamCaption})}



! 

Cookie Sanity check.

!


\begin{DoxyParams}{Parameters}
{\em tib\+\_\+ptr} & the TIB to check. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
if the cookie is enabled, true; false otherwise 
\end{DoxyReturn}
\Hypertarget{_thread_local_storage_8h_aa3ef907fcf7b76f131f51e0de02100f6}\label{_thread_local_storage_8h_aa3ef907fcf7b76f131f51e0de02100f6} 
\index{ThreadLocalStorage.h@{ThreadLocalStorage.h}!tls\_delete\_ptr@{tls\_delete\_ptr}}
\index{tls\_delete\_ptr@{tls\_delete\_ptr}!ThreadLocalStorage.h@{ThreadLocalStorage.h}}
\doxysubsubsection{\texorpdfstring{tls\_delete\_ptr()}{tls\_delete\_ptr()}\hspace{0.1cm}{\footnotesize\ttfamily [1/3]}}
{\footnotesize\ttfamily template$<$typename T $>$ \\
\mbox{\hyperlink{namespace_ne_o_s_ad5f3c5e87966b36f6741ac5897f80120}{Ne\+OS\+::\+Bool}} tls\+\_\+delete\+\_\+ptr (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_ne_o_s_1_1_error_or}{Ne\+OS\+::\+Error\+Or}}$<$ T \texorpdfstring{$\ast$}{*} $>$}]{obj }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [noexcept]}}



Delete process pointer. 


\begin{DoxyParams}{Parameters}
{\em obj} & The pointer to delete. \\
\hline
\end{DoxyParams}
\Hypertarget{_thread_local_storage_8h_a6f08739957d1e7e2d02535186da2b378}\label{_thread_local_storage_8h_a6f08739957d1e7e2d02535186da2b378} 
\index{ThreadLocalStorage.h@{ThreadLocalStorage.h}!tls\_delete\_ptr@{tls\_delete\_ptr}}
\index{tls\_delete\_ptr@{tls\_delete\_ptr}!ThreadLocalStorage.h@{ThreadLocalStorage.h}}
\doxysubsubsection{\texorpdfstring{tls\_delete\_ptr()}{tls\_delete\_ptr()}\hspace{0.1cm}{\footnotesize\ttfamily [2/3]}}
{\footnotesize\ttfamily template$<$typename T $>$ \\
\mbox{\hyperlink{namespace_ne_o_s_ad5f3c5e87966b36f6741ac5897f80120}{Ne\+OS\+::\+Bool}} tls\+\_\+delete\+\_\+ptr (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_ne_o_s_1_1_error_or}{Ne\+OS\+::\+Error\+Or}}$<$ T $>$}]{obj }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [noexcept]}}



Delete process pointer. 


\begin{DoxyParams}{Parameters}
{\em obj} & The pointer to delete. \\
\hline
\end{DoxyParams}
\Hypertarget{_thread_local_storage_8h_ab385bd8ac0de475e955abe3aafe222f8}\label{_thread_local_storage_8h_ab385bd8ac0de475e955abe3aafe222f8} 
\index{ThreadLocalStorage.h@{ThreadLocalStorage.h}!tls\_delete\_ptr@{tls\_delete\_ptr}}
\index{tls\_delete\_ptr@{tls\_delete\_ptr}!ThreadLocalStorage.h@{ThreadLocalStorage.h}}
\doxysubsubsection{\texorpdfstring{tls\_delete\_ptr()}{tls\_delete\_ptr()}\hspace{0.1cm}{\footnotesize\ttfamily [3/3]}}
{\footnotesize\ttfamily template$<$typename T $>$ \\
\mbox{\hyperlink{namespace_ne_o_s_a3245bb65efabbdafe2c6b73041d782e0}{Ne\+OS\+::\+Boolean}} tls\+\_\+delete\+\_\+ptr (\begin{DoxyParamCaption}\item[{T \texorpdfstring{$\ast$}{*}}]{obj }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [noexcept]}}



! 

delete ptr syscall.

!


\begin{DoxyParams}{Parameters}
{\em obj} & The pointer to delete. \\
\hline
\end{DoxyParams}
\Hypertarget{_thread_local_storage_8h_aeb447845d0d9eee77a67d2bd3bd4d86f}\label{_thread_local_storage_8h_aeb447845d0d9eee77a67d2bd3bd4d86f} 
\index{ThreadLocalStorage.h@{ThreadLocalStorage.h}!tls\_new\_class@{tls\_new\_class}}
\index{tls\_new\_class@{tls\_new\_class}!ThreadLocalStorage.h@{ThreadLocalStorage.h}}
\doxysubsubsection{\texorpdfstring{tls\_new\_class()}{tls\_new\_class()}}
{\footnotesize\ttfamily template$<$typename T , typename... Args$>$ \\
T \texorpdfstring{$\ast$}{*} tls\+\_\+new\+\_\+class (\begin{DoxyParamCaption}\item[{Args \&\&...}]{args }\end{DoxyParamCaption})}



Allocate a C++ class, and then call the constructor of it. 


\begin{DoxyTemplParams}{Template Parameters}
{\em T} & class type. \\
\hline
{\em ...\+Args} & varg class type. \\
\hline
\end{DoxyTemplParams}

\begin{DoxyParams}{Parameters}
{\em args} & arguments list. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Class instance. 
\end{DoxyReturn}
\Hypertarget{_thread_local_storage_8h_a3e273becb8719d0ad0de7253b51dd2be}\label{_thread_local_storage_8h_a3e273becb8719d0ad0de7253b51dd2be} 
\index{ThreadLocalStorage.h@{ThreadLocalStorage.h}!tls\_new\_ptr@{tls\_new\_ptr}}
\index{tls\_new\_ptr@{tls\_new\_ptr}!ThreadLocalStorage.h@{ThreadLocalStorage.h}}
\doxysubsubsection{\texorpdfstring{tls\_new\_ptr()}{tls\_new\_ptr()}}
{\footnotesize\ttfamily template$<$typename T $>$ \\
T \texorpdfstring{$\ast$}{*} tls\+\_\+new\+\_\+ptr (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [noexcept]}}



! 

new ptr syscall. 