\doxysection{Boot\+Kit.\+h}
\hypertarget{_boot_kit_8h_source}{}\label{_boot_kit_8h_source}\index{dev/boot/BootKit/BootKit.h@{dev/boot/BootKit/BootKit.h}}
\mbox{\hyperlink{_boot_kit_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{/*\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00002\ \textcolor{comment}{}}
\DoxyCodeLine{00003\ \textcolor{comment}{\ \ \ \ Copyright\ (C)\ 2024-\/2025,\ Amlal\ EL\ Mahrouss,\ all\ rights\ reserved.}}
\DoxyCodeLine{00004\ \textcolor{comment}{}}
\DoxyCodeLine{00005\ \textcolor{comment}{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/\ */}}
\DoxyCodeLine{00006\ }
\DoxyCodeLine{00007\ \textcolor{comment}{/***********************************************************************************/}}
\DoxyCodeLine{00010\ \textcolor{comment}{/***********************************************************************************/}}
\DoxyCodeLine{00011\ }
\DoxyCodeLine{00012\ \textcolor{preprocessor}{\#pragma\ once}}
\DoxyCodeLine{00013\ }
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{boot_2_boot_kit_2_h_w_2_a_t_a_8h}{BootKit/HW/ATA.h}}>}}
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{kernel_2_firmware_kit_2_e_p_m_8h}{FirmwareKit/EPM.h}}>}}
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{_version_8h}{CompilerKit/Version.h}}>}}
\DoxyCodeLine{00017\ \textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{_f_b_mgr_8h}{modules/CoreGfx/FBMgr.h}}>}}
\DoxyCodeLine{00018\ \textcolor{preprocessor}{\#include\ <BootKit/Rsrc/zka\_disk.rsrc>}}
\DoxyCodeLine{00019\ \textcolor{preprocessor}{\#include\ <BootKit/Rsrc/zka\_no\_disk.rsrc>}}
\DoxyCodeLine{00020\ \textcolor{preprocessor}{\#include\ <BootKit/Rsrc/zka\_has\_disk.rsrc>}}
\DoxyCodeLine{00021\ }
\DoxyCodeLine{00023\ }
\DoxyCodeLine{00024\ \textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{_ne_f_s_8h}{FSKit/NeFS.h}}>}}
\DoxyCodeLine{00025\ \textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{_support_8h}{BootKit/Support.h}}>}}
\DoxyCodeLine{00026\ }
\DoxyCodeLine{00027\ \textcolor{comment}{/***********************************************************************************/}}
\DoxyCodeLine{00029\ \textcolor{comment}{/***********************************************************************************/}}
\DoxyCodeLine{00030\ }
\DoxyCodeLine{00031\ \textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{kernel_2_new_kit_2_defines_8h}{NewKit/Defines.h}}>}}
\DoxyCodeLine{00032\ \textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{modules_2_a_t_a_2_a_t_a_8h}{modules/ATA/ATA.h}}>}}
\DoxyCodeLine{00033\ }
\DoxyCodeLine{00034\ \textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{_e_f_i_8h}{FirmwareKit/EFI.h}}>}}
\DoxyCodeLine{00035\ }
\DoxyCodeLine{00036\ \textcolor{comment}{/***********************************************************************************/}}
\DoxyCodeLine{00038\ \textcolor{comment}{/***********************************************************************************/}}
\DoxyCodeLine{00039\ }
\DoxyCodeLine{00040\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespace_boot}{Boot}}}
\DoxyCodeLine{00041\ \{}
\DoxyCodeLine{00042\ \ \ \ \ \mbox{\hyperlink{kernel_2_new_kit_2_macros_8h_a77366c1bd428629dc898e188bfd182a3}{EXTERN}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{namespace_boot_a770cf51bd60eaa15b9a35af8f2b5bc3b}{ThrowError}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{namespace_ne_o_s_a47c41d4526d5406d0f76828b483217e2}{WideChar}}*\ errorCode,}
\DoxyCodeLine{00043\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespace_ne_o_s_a47c41d4526d5406d0f76828b483217e2}{WideChar}}*\ reason)\ \textcolor{keyword}{noexcept};}
\DoxyCodeLine{00044\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00045\ \ \ \ \ \textcolor{keyword}{class\ }\mbox{\hyperlink{class_boot_1_1_boot_text_writer}{BootTextWriter}};}
\DoxyCodeLine{00046\ \ \ \ \ \textcolor{keyword}{class\ }\mbox{\hyperlink{class_boot_1_1_boot_file_reader}{BootFileReader}};}
\DoxyCodeLine{00047\ \ \ \ \ \textcolor{keyword}{class\ }\mbox{\hyperlink{class_boot_1_1_boot_thread}{BootThread}};}
\DoxyCodeLine{00048\ \ \ \ \ \textcolor{keyword}{class\ }\mbox{\hyperlink{class_boot_1_1_b_version_string}{BVersionString}};}
\DoxyCodeLine{00049\ }
\DoxyCodeLine{00050\ \ \ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{namespace_ne_o_s_af96b578c23518d339d562bbab4efa72f}{Char}}*\ \mbox{\hyperlink{namespace_boot_ac67bee9ccd686407f223b58b860bc6d0}{PEFImagePtr}};}
\DoxyCodeLine{00051\ \ \ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{namespace_ne_o_s_af96b578c23518d339d562bbab4efa72f}{Char}}*\ \mbox{\hyperlink{namespace_boot_ac6c34d095a1f0a7c06f5b87964c78191}{PEImagePtr}};}
\DoxyCodeLine{00052\ }
\DoxyCodeLine{00053\ \ \ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{namespace_ne_o_s_a47c41d4526d5406d0f76828b483217e2}{WideChar}}\ \mbox{\hyperlink{namespace_boot_ae3c6485eaee1c210cf856d442ce3c7a7}{CharacterTypeUTF16}};}
\DoxyCodeLine{00054\ \ \ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{namespace_ne_o_s_af96b578c23518d339d562bbab4efa72f}{Char}}\ \ \ \ \ \mbox{\hyperlink{namespace_boot_af4fbfbcef45cf86b54114a8d8ac49525}{CharacterTypeUTF8}};}
\DoxyCodeLine{00055\ }
\DoxyCodeLine{00056\ \ \ \ \ \textcolor{keyword}{using\ namespace\ }\mbox{\hyperlink{namespace_ne_o_s}{NeOS}};}
\DoxyCodeLine{00057\ }
\DoxyCodeLine{00062\ \ \ \ \ \textcolor{keyword}{class\ }\mbox{\hyperlink{class_boot_1_1_boot_text_writer}{BootTextWriter}}\ final}
\DoxyCodeLine{00063\ \ \ \ \ \{}
\DoxyCodeLine{00064\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_boot_1_1_boot_text_writer}{BootTextWriter}}\&\ \mbox{\hyperlink{class_boot_1_1_boot_text_writer_a1fde31bad54f60d9cfe7a680f9601388}{\_Write}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{namespace_ne_o_s_ada093c29aefef728f900e05a6fccec3d}{Long}}\&\ num);}
\DoxyCodeLine{00065\ }
\DoxyCodeLine{00066\ \ \ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00067\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_boot_1_1_boot_text_writer}{BootTextWriter}}\&\ \mbox{\hyperlink{modules_2_a_h_c_i_2_a_h_c_i_8h_a7a9e0d1c2c1ac92baa698f393e953c87}{Write}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{namespace_ne_o_s_ada093c29aefef728f900e05a6fccec3d}{Long}}\&\ num);}
\DoxyCodeLine{00068\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_boot_1_1_boot_text_writer}{BootTextWriter}}\&\ \mbox{\hyperlink{modules_2_a_h_c_i_2_a_h_c_i_8h_a7a9e0d1c2c1ac92baa698f393e953c87}{Write}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{namespace_ne_o_s_af96b578c23518d339d562bbab4efa72f}{Char}}*\ str);}
\DoxyCodeLine{00069\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_boot_1_1_boot_text_writer}{BootTextWriter}}\&\ \mbox{\hyperlink{modules_2_a_h_c_i_2_a_h_c_i_8h_a7a9e0d1c2c1ac92baa698f393e953c87}{Write}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{namespace_boot_ae3c6485eaee1c210cf856d442ce3c7a7}{CharacterTypeUTF16}}*\ str);}
\DoxyCodeLine{00070\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_boot_1_1_boot_text_writer}{BootTextWriter}}\&\ \mbox{\hyperlink{class_boot_1_1_boot_text_writer_a9e3b75e246325e1a438def9cbf54677b}{WriteCharacter}}(\mbox{\hyperlink{namespace_boot_ae3c6485eaee1c210cf856d442ce3c7a7}{CharacterTypeUTF16}}\ c);}
\DoxyCodeLine{00071\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_boot_1_1_boot_text_writer}{BootTextWriter}}\&\ \mbox{\hyperlink{modules_2_a_h_c_i_2_a_h_c_i_8h_a7a9e0d1c2c1ac92baa698f393e953c87}{Write}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{namespace_ne_o_s_adb8ea8dee4caf819742316fb6b013d8e}{UChar}}*\ str);}
\DoxyCodeLine{00072\ }
\DoxyCodeLine{00073\ \ \ \ \ \ \ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00074\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_boot_1_1_boot_text_writer}{BootTextWriter}}\&\ \mbox{\hyperlink{class_boot_1_1_boot_text_writer_a1118b779248ffb08aa5e87f92c8af05d}{operator<<}}(T\ elem)}
\DoxyCodeLine{00075\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00076\ \ \ \ \ \ \ \ \ \ \ \ \ this-\/>\mbox{\hyperlink{modules_2_a_h_c_i_2_a_h_c_i_8h_a7a9e0d1c2c1ac92baa698f393e953c87}{Write}}(elem);}
\DoxyCodeLine{00077\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};}
\DoxyCodeLine{00078\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00079\ }
\DoxyCodeLine{00080\ \ \ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00081\ \ \ \ \ \ \ \ \ \textcolor{keyword}{explicit}\ \mbox{\hyperlink{class_boot_1_1_boot_text_writer_aa9e52c2f21d4426330430536c9b7dfb0}{BootTextWriter}}()\ =\ \textcolor{keywordflow}{default};}
\DoxyCodeLine{00082\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_boot_1_1_boot_text_writer_ac732bf1901ecd32234e7dca6cbe9fb44}{\string~BootTextWriter}}()\ \ \ \ \ \ \ \ \ \ =\ \textcolor{keywordflow}{default};}
\DoxyCodeLine{00083\ }
\DoxyCodeLine{00084\ \ \ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00085\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_boot_1_1_boot_text_writer}{BootTextWriter}}\&\ \mbox{\hyperlink{class_boot_1_1_boot_text_writer_a331334cc0c6bc4aee81028b7e8ffd011}{operator=}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_boot_1_1_boot_text_writer}{BootTextWriter}}\&)\ =\ \textcolor{keywordflow}{default};}
\DoxyCodeLine{00086\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_boot_1_1_boot_text_writer_a6921b73b7596f68966d766f30244c624}{BootTextWriter}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_boot_1_1_boot_text_writer}{BootTextWriter}}\&)\ \ \ \ \ \ \ \ \ \ \ \ =\ \textcolor{keywordflow}{default};}
\DoxyCodeLine{00087\ \ \ \ \ \};}
\DoxyCodeLine{00088\ }
\DoxyCodeLine{00089\ \ \ \ \ \mbox{\hyperlink{namespace_ne_o_s_a5bbd9eec89d9fb8e95178b14ce2fcafc}{NeOS::SizeT}}\ \mbox{\hyperlink{namespace_boot_a2c0c2df329d4e99ad0f602be6adaf79c}{BCopyMem}}(\mbox{\hyperlink{namespace_boot_ae3c6485eaee1c210cf856d442ce3c7a7}{CharacterTypeUTF16}}*\ dest,\ \mbox{\hyperlink{namespace_boot_ae3c6485eaee1c210cf856d442ce3c7a7}{CharacterTypeUTF16}}*\ src,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespace_ne_o_s_a5bbd9eec89d9fb8e95178b14ce2fcafc}{NeOS::SizeT}}\ len);}
\DoxyCodeLine{00090\ }
\DoxyCodeLine{00091\ \ \ \ \ \mbox{\hyperlink{namespace_ne_o_s_a5bbd9eec89d9fb8e95178b14ce2fcafc}{NeOS::SizeT}}\ \mbox{\hyperlink{namespace_boot_a970eb4520f61c7b2b07ad7eece6f5f38}{BSetMem}}(\mbox{\hyperlink{namespace_boot_af4fbfbcef45cf86b54114a8d8ac49525}{CharacterTypeUTF8}}*\ src,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespace_boot_af4fbfbcef45cf86b54114a8d8ac49525}{CharacterTypeUTF8}}\ \textcolor{keywordtype}{byte},\ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespace_ne_o_s_a5bbd9eec89d9fb8e95178b14ce2fcafc}{NeOS::SizeT}}\ len);}
\DoxyCodeLine{00092\ }
\DoxyCodeLine{00094\ }
\DoxyCodeLine{00096\ \ \ \ \ \mbox{\hyperlink{namespace_ne_o_s_a5bbd9eec89d9fb8e95178b14ce2fcafc}{NeOS::SizeT}}\ \mbox{\hyperlink{namespace_boot_ab46b01895780074cda4a98a4d1f00153}{BStrLen}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{namespace_boot_ae3c6485eaee1c210cf856d442ce3c7a7}{CharacterTypeUTF16}}*\ ptr);}
\DoxyCodeLine{00097\ }
\DoxyCodeLine{00099\ \ \ \ \ \mbox{\hyperlink{namespace_ne_o_s_a5bbd9eec89d9fb8e95178b14ce2fcafc}{NeOS::SizeT}}\ \mbox{\hyperlink{namespace_boot_a970eb4520f61c7b2b07ad7eece6f5f38}{BSetMem}}(\mbox{\hyperlink{namespace_boot_ae3c6485eaee1c210cf856d442ce3c7a7}{CharacterTypeUTF16}}*\ src,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespace_boot_ae3c6485eaee1c210cf856d442ce3c7a7}{CharacterTypeUTF16}}\ \textcolor{keywordtype}{byte},\ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespace_ne_o_s_a5bbd9eec89d9fb8e95178b14ce2fcafc}{NeOS::SizeT}}\ len);}
\DoxyCodeLine{00100\ }
\DoxyCodeLine{00105\ \ \ \ \ \textcolor{keyword}{class\ }\mbox{\hyperlink{class_boot_1_1_boot_file_reader}{BootFileReader}}\ final}
\DoxyCodeLine{00106\ \ \ \ \ \{}
\DoxyCodeLine{00107\ \ \ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00108\ \ \ \ \ \ \ \ \ \textcolor{keyword}{explicit}\ \mbox{\hyperlink{class_boot_1_1_boot_file_reader}{BootFileReader}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{namespace_boot_ae3c6485eaee1c210cf856d442ce3c7a7}{CharacterTypeUTF16}}*\ path,}
\DoxyCodeLine{00109\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_efi_handle}{EfiHandlePtr}}\ \ \ \ \ \ \ \ \ \ \ \ \ \ ImageHandle);}
\DoxyCodeLine{00110\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_boot_1_1_boot_file_reader_a5f968f498936ef1feecd3dc947b30ec8}{\string~BootFileReader}}();}
\DoxyCodeLine{00111\ }
\DoxyCodeLine{00112\ \ \ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00113\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_ne_o_s_ad33956dfc567efebd063d7bc6d1ae82d}{Void}}\ \mbox{\hyperlink{class_boot_1_1_boot_file_reader_a64e092acf84df58b190018577c40e943}{ReadAll}}(\mbox{\hyperlink{namespace_ne_o_s_a5bbd9eec89d9fb8e95178b14ce2fcafc}{SizeT}}\ until,\ \mbox{\hyperlink{namespace_ne_o_s_a5bbd9eec89d9fb8e95178b14ce2fcafc}{SizeT}}\ chunk\ =\ \mbox{\hyperlink{kernel_2_new_kit_2_macros_8h_a52e48c290bb7842c6640ef253c9023ab}{kib\_cast}}(4),\ \mbox{\hyperlink{namespace_ne_o_s_a45d30b4091e6c91b5e25bcf408ca6dbb}{UIntPtr}}\ out\_address\ =\ 0UL);}
\DoxyCodeLine{00114\ }
\DoxyCodeLine{00115\ \ \ \ \ \ \ \ \ \textcolor{keyword}{enum}}
\DoxyCodeLine{00116\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00117\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_boot_1_1_boot_file_reader_ab8230eecaf2553f168a2e80a04d261cdab2c10a54343a886c98e832e24aacf704}{kOperationOkay}},}
\DoxyCodeLine{00118\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_boot_1_1_boot_file_reader_ab8230eecaf2553f168a2e80a04d261cdaaa5bab47e4cd27770c64670dfd0365a7}{kNotSupported}},}
\DoxyCodeLine{00119\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_boot_1_1_boot_file_reader_ab8230eecaf2553f168a2e80a04d261cdaae5951c387cd09263d94f292b653be07}{kEmptyDirectory}},}
\DoxyCodeLine{00120\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_boot_1_1_boot_file_reader_ab8230eecaf2553f168a2e80a04d261cda3d2c9e8138e4e4cc1a684867e8558d2d}{kNoSuchEntry}},}
\DoxyCodeLine{00121\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_boot_1_1_boot_file_reader_ab8230eecaf2553f168a2e80a04d261cda3ef80ea903a233cab218afb285da7206}{kIsDirectory}},}
\DoxyCodeLine{00122\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_boot_1_1_boot_file_reader_ab8230eecaf2553f168a2e80a04d261cdaea2adf8bcf6c6e100e75e7bd9cd88129}{kTooSmall}},}
\DoxyCodeLine{00123\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_boot_1_1_boot_file_reader_ab8230eecaf2553f168a2e80a04d261cdac6386e81c848e5b556a863951774da72}{kCount}},}
\DoxyCodeLine{00124\ \ \ \ \ \ \ \ \ \};}
\DoxyCodeLine{00125\ }
\DoxyCodeLine{00128\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_ne_o_s_a91a19724952b6c6faf9b52f9efc935f7}{Int32}}\&\ \mbox{\hyperlink{class_boot_1_1_boot_file_reader_ad2d04a3f2dd07a75384ffaf2dcf33f3a}{Error}}();}
\DoxyCodeLine{00129\ }
\DoxyCodeLine{00132\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_ne_o_s_ac1c63bbbae84b587c92428c1f2025036}{VoidPtr}}\ \mbox{\hyperlink{class_boot_1_1_boot_file_reader_a05139a4cef8b9a373befa56ddae8a01d}{Blob}}();}
\DoxyCodeLine{00133\ }
\DoxyCodeLine{00136\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_ne_o_s_a09d79cd68f15b02280f00125b4e62cb5}{UInt64}}\&\ \mbox{\hyperlink{class_boot_1_1_boot_file_reader_ab473e83d91315225409d47a95e16f474}{Size}}();}
\DoxyCodeLine{00137\ }
\DoxyCodeLine{00138\ \ \ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00139\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_boot_1_1_boot_file_reader}{BootFileReader}}\&\ \mbox{\hyperlink{class_boot_1_1_boot_file_reader_a5934810e71e96fce88695e17635aaf9f}{operator=}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_boot_1_1_boot_file_reader}{BootFileReader}}\&)\ =\ \textcolor{keywordflow}{default};}
\DoxyCodeLine{00140\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_boot_1_1_boot_file_reader_af3ae33e9869188a36da5044114c2cd30}{BootFileReader}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_boot_1_1_boot_file_reader}{BootFileReader}}\&)\ \ \ \ \ \ \ \ \ \ \ \ =\ \textcolor{keywordflow}{default};}
\DoxyCodeLine{00141\ }
\DoxyCodeLine{00142\ \ \ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00143\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_ne_o_s_a91a19724952b6c6faf9b52f9efc935f7}{Int32}}\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_boot_1_1_boot_file_reader_a1552fde8c566bea1cfc28d589be9fea0}{mErrorCode}}\{\mbox{\hyperlink{class_boot_1_1_boot_file_reader_ab8230eecaf2553f168a2e80a04d261cdab2c10a54343a886c98e832e24aacf704}{kOperationOkay}}\};}
\DoxyCodeLine{00144\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_ne_o_s_ac1c63bbbae84b587c92428c1f2025036}{VoidPtr}}\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_boot_1_1_boot_file_reader_a1f3da6bfbc63efd21597229ff53f3e7e}{mBlob}}\{\textcolor{keyword}{nullptr}\};}
\DoxyCodeLine{00145\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_boot_ae3c6485eaee1c210cf856d442ce3c7a7}{CharacterTypeUTF16}}\ \mbox{\hyperlink{class_boot_1_1_boot_file_reader_a771332c0534ef888d97a434672f65129}{mPath}}[\mbox{\hyperlink{kernel_2_new_kit_2_macros_8h_a348e01990cb6bce27f125183c9722b91}{kPathLen}}];}
\DoxyCodeLine{00146\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_boot_1_1_boot_text_writer}{BootTextWriter}}\ \ \ \ \ \ \ \mbox{\hyperlink{class_boot_1_1_boot_file_reader_a0a41b6a5745e95fd0988849be7f8a771}{mWriter}};}
\DoxyCodeLine{00147\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_efi_file_protocol}{EfiFileProtocol}}*\ \ \ \mbox{\hyperlink{class_boot_1_1_boot_file_reader_abb0ae9ab1ca6082dc4efedbdf4b22459}{mFile}}\{\textcolor{keyword}{nullptr}\};}
\DoxyCodeLine{00148\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_ne_o_s_a09d79cd68f15b02280f00125b4e62cb5}{UInt64}}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_boot_1_1_boot_file_reader_aaba2eae9fc8e6d8a8153219bc4018e56}{mSizeFile}}\{0\};}
\DoxyCodeLine{00149\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_efi_file_protocol}{EfiFileProtocol}}*\ \ \ \mbox{\hyperlink{class_boot_1_1_boot_file_reader_aa4dcdba9c1ca93775a69672a15d98218}{mRootFs}};}
\DoxyCodeLine{00150\ \ \ \ \ \};}
\DoxyCodeLine{00151\ }
\DoxyCodeLine{00152\ \ \ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{namespace_ne_o_s_a0835cc5d92716e99fd7387e297984399}{UInt8}}*\ \mbox{\hyperlink{namespace_boot_ad34c776f9a2e68bf9ceb558f73dbf68c}{BlobType}};}
\DoxyCodeLine{00153\ }
\DoxyCodeLine{00154\ \ \ \ \ \textcolor{keyword}{class\ }\mbox{\hyperlink{class_boot_1_1_b_version_string}{BVersionString}}\ final}
\DoxyCodeLine{00155\ \ \ \ \ \{}
\DoxyCodeLine{00156\ \ \ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00157\ \ \ \ \ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespace_boot_af4fbfbcef45cf86b54114a8d8ac49525}{CharacterTypeUTF8}}*\ \mbox{\hyperlink{class_boot_1_1_b_version_string_a2f414445be91746121945a78fbcb8315}{The}}()}
\DoxyCodeLine{00158\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00159\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{_version_8h_aa8c740e2a3cccdd038fdfa35c0f175ec}{BOOTLOADER\_VERSION}};}
\DoxyCodeLine{00160\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00161\ \ \ \ \ \};}
\DoxyCodeLine{00162\ }
\DoxyCodeLine{00163\ \textcolor{comment}{\ \ \ \ /***********************************************************************************/}}
\DoxyCodeLine{00165\ \textcolor{comment}{\ \ \ \ /***********************************************************************************/}}
\DoxyCodeLine{00166\ }
\DoxyCodeLine{00167\ \textcolor{preprocessor}{\#ifdef\ \_\_EFI\_x86\_64\_\_}}
\DoxyCodeLine{00168\ }
\DoxyCodeLine{00169\ \textcolor{comment}{\ \ \ \ /***}}
\DoxyCodeLine{00170\ \textcolor{comment}{\ \ \ \ \ *\ Common\ processor\ instructions.}}
\DoxyCodeLine{00171\ \textcolor{comment}{\ \ \ \ \ */}}
\DoxyCodeLine{00172\ }
\DoxyCodeLine{00173\ \ \ \ \ \mbox{\hyperlink{kernel_2_new_kit_2_macros_8h_abbaccfbed35b945162c27ef6d3748e77}{EXTERN\_C}}\ \textcolor{keywordtype}{void}\ \ \ rt\_out8(\mbox{\hyperlink{namespace_ne_o_s_a4885ae005fc56130691bdea86d9a88d7}{UInt16}}\ port,\ \mbox{\hyperlink{namespace_ne_o_s_a0835cc5d92716e99fd7387e297984399}{UInt8}}\ value);}
\DoxyCodeLine{00174\ \ \ \ \ \mbox{\hyperlink{kernel_2_new_kit_2_macros_8h_abbaccfbed35b945162c27ef6d3748e77}{EXTERN\_C}}\ \textcolor{keywordtype}{void}\ \ \ rt\_out16(\mbox{\hyperlink{namespace_ne_o_s_a4885ae005fc56130691bdea86d9a88d7}{UInt16}}\ port,\ \mbox{\hyperlink{namespace_ne_o_s_a4885ae005fc56130691bdea86d9a88d7}{UInt16}}\ value);}
\DoxyCodeLine{00175\ \ \ \ \ \mbox{\hyperlink{kernel_2_new_kit_2_macros_8h_abbaccfbed35b945162c27ef6d3748e77}{EXTERN\_C}}\ \textcolor{keywordtype}{void}\ \ \ rt\_out32(\mbox{\hyperlink{namespace_ne_o_s_a4885ae005fc56130691bdea86d9a88d7}{UInt16}}\ port,\ \mbox{\hyperlink{namespace_ne_o_s_a160d206409956603d46f6292a41b1f52}{UInt32}}\ value);}
\DoxyCodeLine{00176\ \ \ \ \ \mbox{\hyperlink{kernel_2_new_kit_2_macros_8h_abbaccfbed35b945162c27ef6d3748e77}{EXTERN\_C}}\ \mbox{\hyperlink{namespace_ne_o_s_a0835cc5d92716e99fd7387e297984399}{UInt8}}\ rt\_in8(\mbox{\hyperlink{namespace_ne_o_s_a4885ae005fc56130691bdea86d9a88d7}{UInt16}}\ port);}
\DoxyCodeLine{00177\ \ \ \ \ \mbox{\hyperlink{kernel_2_new_kit_2_macros_8h_abbaccfbed35b945162c27ef6d3748e77}{EXTERN\_C}}\ \mbox{\hyperlink{namespace_ne_o_s_a4885ae005fc56130691bdea86d9a88d7}{UInt16}}\ In16(\mbox{\hyperlink{namespace_ne_o_s_a4885ae005fc56130691bdea86d9a88d7}{UInt16}}\ port);}
\DoxyCodeLine{00178\ \ \ \ \ \mbox{\hyperlink{kernel_2_new_kit_2_macros_8h_abbaccfbed35b945162c27ef6d3748e77}{EXTERN\_C}}\ \mbox{\hyperlink{namespace_ne_o_s_a160d206409956603d46f6292a41b1f52}{UInt32}}\ rt\_in32(\mbox{\hyperlink{namespace_ne_o_s_a4885ae005fc56130691bdea86d9a88d7}{UInt16}}\ port);}
\DoxyCodeLine{00179\ }
\DoxyCodeLine{00180\ \ \ \ \ \mbox{\hyperlink{kernel_2_new_kit_2_macros_8h_abbaccfbed35b945162c27ef6d3748e77}{EXTERN\_C}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{_a_m_d64_2_boot_platform_8cc_a4e5fc109991d7736ddadd761b0a24113}{rt\_hlt}}();}
\DoxyCodeLine{00181\ \ \ \ \ \mbox{\hyperlink{kernel_2_new_kit_2_macros_8h_abbaccfbed35b945162c27ef6d3748e77}{EXTERN\_C}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{_a_p_i_8h_a12e982db5e3c511132fa1479d1d447ec}{rt\_cli}}();}
\DoxyCodeLine{00182\ \ \ \ \ \mbox{\hyperlink{kernel_2_new_kit_2_macros_8h_abbaccfbed35b945162c27ef6d3748e77}{EXTERN\_C}}\ \textcolor{keywordtype}{void}\ rt\_sti();}
\DoxyCodeLine{00183\ \ \ \ \ \mbox{\hyperlink{kernel_2_new_kit_2_macros_8h_abbaccfbed35b945162c27ef6d3748e77}{EXTERN\_C}}\ \textcolor{keywordtype}{void}\ rt\_cld();}
\DoxyCodeLine{00184\ \ \ \ \ \mbox{\hyperlink{kernel_2_new_kit_2_macros_8h_abbaccfbed35b945162c27ef6d3748e77}{EXTERN\_C}}\ \textcolor{keywordtype}{void}\ rt\_std();}
\DoxyCodeLine{00185\ }
\DoxyCodeLine{00186\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//\ \_\_EFI\_x86\_64\_\_}}
\DoxyCodeLine{00187\ }
\DoxyCodeLine{00188\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{inline}\ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespace_ne_o_s_a160d206409956603d46f6292a41b1f52}{UInt32}}\ kRgbRed\ \ \ \ \ =\ 0x000000FF;}
\DoxyCodeLine{00189\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{inline}\ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespace_ne_o_s_a160d206409956603d46f6292a41b1f52}{UInt32}}\ kRgbGreen\ =\ 0x0000FF00;}
\DoxyCodeLine{00190\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{inline}\ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespace_ne_o_s_a160d206409956603d46f6292a41b1f52}{UInt32}}\ kRgbBlue\ \ \ \ =\ 0x00FF0000;}
\DoxyCodeLine{00191\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{inline}\ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespace_ne_o_s_a160d206409956603d46f6292a41b1f52}{UInt32}}\ kRgbBlack\ =\ 0x00000000;}
\DoxyCodeLine{00192\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{inline}\ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespace_ne_o_s_a160d206409956603d46f6292a41b1f52}{UInt32}}\ kRgbWhite\ =\ 0x00FFFFFF;}
\DoxyCodeLine{00193\ }
\DoxyCodeLine{00194\ \textcolor{preprocessor}{\#define\ kBKBootFileMime\ "{}boot-\/x/file"{}}}
\DoxyCodeLine{00195\ \textcolor{preprocessor}{\#define\ kBKBootDirMime\ \ "{}boot-\/x/dir"{}}}
\DoxyCodeLine{00196\ }
\DoxyCodeLine{00198\ \ \ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ BootDev>}
\DoxyCodeLine{00199\ \ \ \ \ \textcolor{keyword}{class\ }\mbox{\hyperlink{class_boot_1_1_b_disk_format_factory}{BDiskFormatFactory}}\ final}
\DoxyCodeLine{00200\ \ \ \ \ \{}
\DoxyCodeLine{00201\ \ \ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00203\ \ \ \ \ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_boot_1_1_b_disk_format_factory_1_1_b_file_descriptor}{BFileDescriptor}}\ final}
\DoxyCodeLine{00204\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00205\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_ne_o_s_af96b578c23518d339d562bbab4efa72f}{Char}}\ \ \mbox{\hyperlink{struct_boot_1_1_b_disk_format_factory_1_1_b_file_descriptor_a94adc7f711f7599802bc1390ab2b7f2d}{fFileName}}[\mbox{\hyperlink{_ne_f_s_8h_a87fd947a9f17688b55acd361f064b5ca}{kNeFSCatalogNameLen}}];}
\DoxyCodeLine{00206\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_ne_o_s_a91a19724952b6c6faf9b52f9efc935f7}{Int32}}\ \mbox{\hyperlink{struct_boot_1_1_b_disk_format_factory_1_1_b_file_descriptor_a88be5a1f5ecf32e0d24d2f8fce990068}{fKind}};}
\DoxyCodeLine{00207\ \ \ \ \ \ \ \ \ \};}
\DoxyCodeLine{00208\ }
\DoxyCodeLine{00209\ \ \ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00210\ \ \ \ \ \ \ \ \ \textcolor{keyword}{explicit}\ \mbox{\hyperlink{class_boot_1_1_b_disk_format_factory_a587ba91809d63db941d293adec18e12c}{BDiskFormatFactory}}()\ =\ \textcolor{keywordflow}{default};}
\DoxyCodeLine{00211\ \ \ \ \ \ \ \ \ \textcolor{keyword}{explicit}\ \mbox{\hyperlink{class_boot_1_1_b_disk_format_factory_a764e295d20f9ae0779d310f437e859d6}{BDiskFormatFactory}}(BootDev\ dev)}
\DoxyCodeLine{00212\ \ \ \ \ \ \ \ \ \ \ \ \ :\ \mbox{\hyperlink{class_boot_1_1_b_disk_format_factory_a7b385dc251a8c5e1413c643fd88a6bef}{fDiskDev}}(dev)}
\DoxyCodeLine{00213\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00214\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00215\ }
\DoxyCodeLine{00216\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_boot_1_1_b_disk_format_factory_a0a199e499c1750943135f680191fb851}{\string~BDiskFormatFactory}}()\ =\ \textcolor{keywordflow}{default};}
\DoxyCodeLine{00217\ }
\DoxyCodeLine{00218\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_boot_1_1_b_disk_format_factory_ab3848aaf09f95a7af54887604582accf}{NE\_COPY\_DELETE}}(\mbox{\hyperlink{class_boot_1_1_b_disk_format_factory}{BDiskFormatFactory}});}
\DoxyCodeLine{00219\ }
\DoxyCodeLine{00226\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_ne_o_s_a3245bb65efabbdafe2c6b73041d782e0}{Boolean}}\ \mbox{\hyperlink{class_boot_1_1_b_disk_format_factory_a0753231c031defa3092b4fa23b3a1d47}{Format}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{namespace_ne_o_s_af96b578c23518d339d562bbab4efa72f}{Char}}*\ part\_name,\ \mbox{\hyperlink{struct_boot_1_1_b_disk_format_factory_1_1_b_file_descriptor}{BFileDescriptor}}*\ blob,\ \mbox{\hyperlink{namespace_ne_o_s_a5bbd9eec89d9fb8e95178b14ce2fcafc}{SizeT}}\ blob\_sz);}
\DoxyCodeLine{00227\ }
\DoxyCodeLine{00229\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_ne_o_s_ad5f3c5e87966b36f6741ac5897f80120}{Bool}}\ \mbox{\hyperlink{class_boot_1_1_b_disk_format_factory_a0315f621c0ce9812e0151b150a330cac}{IsPartitionValid}}()\ noexcept}
\DoxyCodeLine{00230\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00231\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_boot_1_1_b_disk_format_factory_a7b385dc251a8c5e1413c643fd88a6bef}{fDiskDev}}.Leak().mBase\ =\ (\mbox{\hyperlink{_ne_f_s_8h_af90b1a36da8473bdb033363e9ef27474}{kNeFSRootCatalogStartAddress}});}
\DoxyCodeLine{00232\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_boot_1_1_b_disk_format_factory_a7b385dc251a8c5e1413c643fd88a6bef}{fDiskDev}}.Leak().mSize\ =\ BootDev::kSectorSize;}
\DoxyCodeLine{00233\ }
\DoxyCodeLine{00234\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_ne_o_s_af96b578c23518d339d562bbab4efa72f}{Char}}\ buf[BootDev::kSectorSize]\ =\ \{0\};}
\DoxyCodeLine{00235\ }
\DoxyCodeLine{00236\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_boot_1_1_b_disk_format_factory_a7b385dc251a8c5e1413c643fd88a6bef}{fDiskDev}}.Read(buf,\ BootDev::kSectorSize);}
\DoxyCodeLine{00237\ }
\DoxyCodeLine{00238\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_n_e_f_s___r_o_o_t___p_a_r_t_i_t_i_o_n___b_l_o_c_k}{NEFS\_ROOT\_PARTITION\_BLOCK}}*\ blockPart\ =\ \textcolor{keyword}{reinterpret\_cast<}\mbox{\hyperlink{struct_n_e_f_s___r_o_o_t___p_a_r_t_i_t_i_o_n___b_l_o_c_k}{NEFS\_ROOT\_PARTITION\_BLOCK}}*\textcolor{keyword}{>}(buf);}
\DoxyCodeLine{00239\ }
\DoxyCodeLine{00240\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_boot_1_1_boot_text_writer}{BootTextWriter}}\ writer;}
\DoxyCodeLine{00241\ }
\DoxyCodeLine{00242\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{namespace_ne_o_s_a5bbd9eec89d9fb8e95178b14ce2fcafc}{SizeT}}\ indexMag\ =\ 0UL;\ indexMag\ <\ \mbox{\hyperlink{_ne_f_s_8h_a4d5831600df92d8486f9a1d25772ead4}{kNeFSIdentLen}};\ ++indexMag)}
\DoxyCodeLine{00243\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00244\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (blockPart-\/>\mbox{\hyperlink{struct_n_e_f_s___r_o_o_t___p_a_r_t_i_t_i_o_n___b_l_o_c_k_a0f2493c0bca5567eee5100e849ed592a}{Ident}}[indexMag]\ !=\ \mbox{\hyperlink{_ne_f_s_8h_aa63173db3f6fc3ff4c5b65e7cdc398b1}{kNeFSIdent}}[indexMag])}
\DoxyCodeLine{00245\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00246\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00247\ }
\DoxyCodeLine{00248\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (blockPart-\/>\mbox{\hyperlink{struct_n_e_f_s___r_o_o_t___p_a_r_t_i_t_i_o_n___b_l_o_c_k_aa8919c8cfb142dfdfb34bafd820f5446}{DiskSize}}\ !=\ this-\/>fDiskDev.GetDiskSize()\ ||}
\DoxyCodeLine{00249\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ blockPart-\/>\mbox{\hyperlink{struct_n_e_f_s___r_o_o_t___p_a_r_t_i_t_i_o_n___b_l_o_c_k_aa8919c8cfb142dfdfb34bafd820f5446}{DiskSize}}\ <\ 1\ ||}
\DoxyCodeLine{00250\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ blockPart-\/>\mbox{\hyperlink{struct_n_e_f_s___r_o_o_t___p_a_r_t_i_t_i_o_n___b_l_o_c_k_a6b2750cfdb357870f908bab7ef7ab5ea}{SectorSize}}\ !=\ BootDev::kSectorSize\ ||}
\DoxyCodeLine{00251\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ blockPart-\/>\mbox{\hyperlink{struct_n_e_f_s___r_o_o_t___p_a_r_t_i_t_i_o_n___b_l_o_c_k_aa96cf3f189e3449ab9635289e0501e0d}{Version}}\ !=\ \mbox{\hyperlink{_ne_f_s_8h_a61176cf58288663dd7c6cd9e060aa945}{kNeFSVersionInteger}}\ ||}
\DoxyCodeLine{00252\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ blockPart-\/>\mbox{\hyperlink{struct_n_e_f_s___r_o_o_t___p_a_r_t_i_t_i_o_n___b_l_o_c_k_a33d3e8dd5fa1bcdfdaadcde1cd11d4b3}{StartCatalog}}\ ==\ 0)}
\DoxyCodeLine{00253\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00254\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00255\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00256\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (blockPart-\/>\mbox{\hyperlink{struct_n_e_f_s___r_o_o_t___p_a_r_t_i_t_i_o_n___b_l_o_c_k_a7886d9d9913404c203d1fabbeb969c4f}{PartitionName}}[0]\ ==\ 0)}
\DoxyCodeLine{00257\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00258\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00259\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00260\ }
\DoxyCodeLine{00261\ \ \ \ \ \ \ \ \ \ \ \ \ writer.\mbox{\hyperlink{class_boot_1_1_boot_text_writer_ab6ced6c2de790ef1f6399e6446011ed4}{Write}}(L\textcolor{stringliteral}{"{}BootZ:\ Partition:\ "{}}).\mbox{\hyperlink{class_boot_1_1_boot_text_writer_ab6ced6c2de790ef1f6399e6446011ed4}{Write}}(blockPart-\/>\mbox{\hyperlink{struct_n_e_f_s___r_o_o_t___p_a_r_t_i_t_i_o_n___b_l_o_c_k_a7886d9d9913404c203d1fabbeb969c4f}{PartitionName}}).\mbox{\hyperlink{class_boot_1_1_boot_text_writer_ab6ced6c2de790ef1f6399e6446011ed4}{Write}}(L\textcolor{stringliteral}{"{}\ is\ healthy.\(\backslash\)r"{}});}
\DoxyCodeLine{00262\ }
\DoxyCodeLine{00263\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00264\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00265\ }
\DoxyCodeLine{00266\ \ \ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00271\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_ne_o_s_a3245bb65efabbdafe2c6b73041d782e0}{Boolean}}\ \mbox{\hyperlink{class_boot_1_1_b_disk_format_factory_a1bcfce8ecf64f70a2d3fcd05bc93d127}{WriteCatalogList}}(\mbox{\hyperlink{struct_boot_1_1_b_disk_format_factory_1_1_b_file_descriptor}{BFileDescriptor}}*\ blob,\ \mbox{\hyperlink{namespace_ne_o_s_a5bbd9eec89d9fb8e95178b14ce2fcafc}{SizeT}}\ blob\_sz,\ \mbox{\hyperlink{struct_n_e_f_s___r_o_o_t___p_a_r_t_i_t_i_o_n___b_l_o_c_k}{NEFS\_ROOT\_PARTITION\_BLOCK}}\&\ part)}
\DoxyCodeLine{00272\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00273\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (blob\_sz\ <\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{struct_n_e_f_s___c_a_t_a_l_o_g___s_t_r_u_c_t}{NEFS\_CATALOG\_STRUCT}}))}
\DoxyCodeLine{00274\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{ddk_8h_a996bde01ecac342918f0a2c4e7ce7bd5}{NO}};}
\DoxyCodeLine{00275\ }
\DoxyCodeLine{00276\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!blob)}
\DoxyCodeLine{00277\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{ddk_8h_a996bde01ecac342918f0a2c4e7ce7bd5}{NO}};}
\DoxyCodeLine{00278\ }
\DoxyCodeLine{00279\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_ne_o_s_a6c7d716f879df82186c7178f1271e502}{Lba}}\ \ \ \ \ \ \ \ \ \ \ \ \ startLba\ =\ part.\mbox{\hyperlink{struct_n_e_f_s___r_o_o_t___p_a_r_t_i_t_i_o_n___b_l_o_c_k_a33d3e8dd5fa1bcdfdaadcde1cd11d4b3}{StartCatalog}};}
\DoxyCodeLine{00280\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_boot_1_1_boot_text_writer}{BootTextWriter}}\ writer;}
\DoxyCodeLine{00281\ }
\DoxyCodeLine{00282\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_n_e_f_s___c_a_t_a_l_o_g___s_t_r_u_c_t}{NEFS\_CATALOG\_STRUCT}}\ catalogKind\{0\};}
\DoxyCodeLine{00283\ }
\DoxyCodeLine{00284\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{constexpr}\ \textcolor{keyword}{auto}\ cNeFSCatalogPadding\ =\ 4;}
\DoxyCodeLine{00285\ }
\DoxyCodeLine{00286\ \ \ \ \ \ \ \ \ \ \ \ \ catalogKind.\mbox{\hyperlink{struct_n_e_f_s___c_a_t_a_l_o_g___s_t_r_u_c_t_a3e6d4910afc01115df1ce5d87abd7eec}{PrevSibling}}\ =\ startLba;}
\DoxyCodeLine{00287\ \ \ \ \ \ \ \ \ \ \ \ \ catalogKind.NextSibling\ =\ (startLba\ +\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{struct_n_e_f_s___c_a_t_a_l_o_g___s_t_r_u_c_t}{NEFS\_CATALOG\_STRUCT}})\ *\ cNeFSCatalogPadding);}
\DoxyCodeLine{00288\ }
\DoxyCodeLine{00290\ \ \ \ \ \ \ \ \ \ \ \ \ catalogKind.Kind\ =\ blob-\/>\mbox{\hyperlink{struct_boot_1_1_b_disk_format_factory_1_1_b_file_descriptor_a88be5a1f5ecf32e0d24d2f8fce990068}{fKind}};}
\DoxyCodeLine{00291\ \ \ \ \ \ \ \ \ \ \ \ \ catalogKind.Flags\ |=\ \mbox{\hyperlink{_ne_f_s_8h_abdc83b3461b6e9a5cf5de76d49afba38}{kNeFSFlagCreated}};}
\DoxyCodeLine{00292\ \ \ \ \ \ \ \ \ \ \ \ \ catalogKind.CatalogFlags\ =\ \mbox{\hyperlink{_ne_f_s_8h_aaf105ae5beaca1dee30ae54530691fceab0d4a3855ba33438d25fecf25f70171b}{kNeFSStatusUnlocked}};}
\DoxyCodeLine{00293\ }
\DoxyCodeLine{00294\ \ \ \ \ \ \ \ \ \ \ \ \ -\/-\/part.\mbox{\hyperlink{struct_n_e_f_s___r_o_o_t___p_a_r_t_i_t_i_o_n___b_l_o_c_k_a1a3dd62316c077dce35e5835926b6ed5}{FreeCatalog}};}
\DoxyCodeLine{00295\ \ \ \ \ \ \ \ \ \ \ \ \ -\/-\/part.\mbox{\hyperlink{struct_n_e_f_s___r_o_o_t___p_a_r_t_i_t_i_o_n___b_l_o_c_k_a4292d6253d5f8967428d9d162f2c0ba2}{FreeSectors}};}
\DoxyCodeLine{00296\ }
\DoxyCodeLine{00297\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{_support_8h_a013574543d2f27a210fdfd5fa284ebe3}{CopyMem}}(catalogKind.Name,\ blob-\/>\mbox{\hyperlink{struct_boot_1_1_b_disk_format_factory_1_1_b_file_descriptor_a94adc7f711f7599802bc1390ab2b7f2d}{fFileName}},\ \mbox{\hyperlink{_support_8h_a94a5b7998848651b99c8b45e19c534d7}{StrLen}}(blob-\/>\mbox{\hyperlink{struct_boot_1_1_b_disk_format_factory_1_1_b_file_descriptor_a94adc7f711f7599802bc1390ab2b7f2d}{fFileName}}));}
\DoxyCodeLine{00298\ }
\DoxyCodeLine{00299\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_boot_1_1_b_disk_format_factory_a7b385dc251a8c5e1413c643fd88a6bef}{fDiskDev}}.Leak().mBase\ =\ startLba;}
\DoxyCodeLine{00300\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_boot_1_1_b_disk_format_factory_a7b385dc251a8c5e1413c643fd88a6bef}{fDiskDev}}.Leak().mSize\ =\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{struct_n_e_f_s___c_a_t_a_l_o_g___s_t_r_u_c_t}{NEFS\_CATALOG\_STRUCT}});}
\DoxyCodeLine{00301\ }
\DoxyCodeLine{00302\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_boot_1_1_b_disk_format_factory_a7b385dc251a8c5e1413c643fd88a6bef}{fDiskDev}}.Write((\mbox{\hyperlink{namespace_ne_o_s_af96b578c23518d339d562bbab4efa72f}{Char}}*)\&catalogKind,\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{struct_n_e_f_s___c_a_t_a_l_o_g___s_t_r_u_c_t}{NEFS\_CATALOG\_STRUCT}}));}
\DoxyCodeLine{00303\ }
\DoxyCodeLine{00304\ \ \ \ \ \ \ \ \ \ \ \ \ writer.\mbox{\hyperlink{class_boot_1_1_boot_text_writer_ab6ced6c2de790ef1f6399e6446011ed4}{Write}}(L\textcolor{stringliteral}{"{}BootZ:\ Wrote\ directory:\ "{}}).\mbox{\hyperlink{class_boot_1_1_boot_text_writer_ab6ced6c2de790ef1f6399e6446011ed4}{Write}}(blob-\/>\mbox{\hyperlink{struct_boot_1_1_b_disk_format_factory_1_1_b_file_descriptor_a94adc7f711f7599802bc1390ab2b7f2d}{fFileName}}).\mbox{\hyperlink{class_boot_1_1_boot_text_writer_ab6ced6c2de790ef1f6399e6446011ed4}{Write}}(L\textcolor{stringliteral}{"{}\(\backslash\)r"{}});}
\DoxyCodeLine{00305\ }
\DoxyCodeLine{00306\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00307\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00308\ }
\DoxyCodeLine{00309\ \ \ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00310\ \ \ \ \ \ \ \ \ BootDev\ \mbox{\hyperlink{class_boot_1_1_b_disk_format_factory_a7b385dc251a8c5e1413c643fd88a6bef}{fDiskDev}};}
\DoxyCodeLine{00311\ \ \ \ \ \};}
\DoxyCodeLine{00312\ }
\DoxyCodeLine{00319\ \ \ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ BootDev>}
\DoxyCodeLine{00320\ \ \ \ \ \textcolor{keyword}{inline}\ \mbox{\hyperlink{namespace_ne_o_s_a3245bb65efabbdafe2c6b73041d782e0}{Boolean}}\ \mbox{\hyperlink{class_boot_1_1_b_disk_format_factory_a0753231c031defa3092b4fa23b3a1d47}{BDiskFormatFactory<BootDev>::Format}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{namespace_ne_o_s_af96b578c23518d339d562bbab4efa72f}{Char}}*\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ part\_name,}
\DoxyCodeLine{00321\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_boot_1_1_b_disk_format_factory_1_1_b_file_descriptor}{BDiskFormatFactory::BFileDescriptor}}*\ blob,}
\DoxyCodeLine{00322\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_ne_o_s_a5bbd9eec89d9fb8e95178b14ce2fcafc}{SizeT}}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ blob\_sz)}
\DoxyCodeLine{00323\ \ \ \ \ \{}
\DoxyCodeLine{00324\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!blob\ ||\ !blob\_sz)}
\DoxyCodeLine{00325\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};\ }
\DoxyCodeLine{00326\ }
\DoxyCodeLine{00328\ }
\DoxyCodeLine{00329\ \ \ \ \ \ \ \ \ \textcolor{keyword}{constexpr}\ \textcolor{keyword}{auto}\ kMinimumDiskSize\ =\ \mbox{\hyperlink{_ne_f_s_8h_acf55712e23e5c7a0e2013d3b51250528}{kNeFSMinimumDiskSize}};\ \textcolor{comment}{//\ at\ minimum.}}
\DoxyCodeLine{00330\ }
\DoxyCodeLine{00332\ }
\DoxyCodeLine{00333\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (fDiskDev.GetDiskSize()\ <\ kMinimumDiskSize)}
\DoxyCodeLine{00334\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00335\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{_f_b_mgr_8h_af426c91c49821bcf155ae7b712e52b1b}{fb\_init}}();}
\DoxyCodeLine{00336\ }
\DoxyCodeLine{00337\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{_f_b_mgr_8h_afe9e38b283f7a8ca6fac220560774ade}{FBDrawBitMapInRegion}}(zka\_no\_disk,\ NE\_NO\_DISK\_WIDTH,\ NE\_NO\_DISK\_HEIGHT,\ (\mbox{\hyperlink{_handover_8h_a48647599f5977443a7b26df988544483}{kHandoverHeader}}-\/>\mbox{\hyperlink{struct_ne_o_s_1_1_h_e_l_1_1_boot_info_header_a78b65e7c4fecaebdc18613ee2ccc7169}{f\_GOP}}.\mbox{\hyperlink{struct_ne_o_s_1_1_h_e_l_1_1_boot_info_header_a99a193471f878b3f57d69894a08784a0}{f\_Width}}\ -\/\ NE\_NO\_DISK\_WIDTH)\ /\ 2,\ (\mbox{\hyperlink{_handover_8h_a48647599f5977443a7b26df988544483}{kHandoverHeader}}-\/>\mbox{\hyperlink{struct_ne_o_s_1_1_h_e_l_1_1_boot_info_header_a78b65e7c4fecaebdc18613ee2ccc7169}{f\_GOP}}.\mbox{\hyperlink{struct_ne_o_s_1_1_h_e_l_1_1_boot_info_header_afa49d59082193c7896e176e31dd2abcb}{f\_Height}}\ -\/\ NE\_NO\_DISK\_HEIGHT)\ /\ 2);}
\DoxyCodeLine{00338\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_boot_a770cf51bd60eaa15b9a35af8f2b5bc3b}{Boot::ThrowError}}(L\textcolor{stringliteral}{"{}Drive-\/Too-\/Tiny"{}},\ L\textcolor{stringliteral}{"{}Can't\ format\ a\ NeFS\ partition\ here."{}});}
\DoxyCodeLine{00339\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00340\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00341\ }
\DoxyCodeLine{00342\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_n_e_f_s___r_o_o_t___p_a_r_t_i_t_i_o_n___b_l_o_c_k}{NEFS\_ROOT\_PARTITION\_BLOCK}}\ part\{0\};}
\DoxyCodeLine{00343\ }
\DoxyCodeLine{00344\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{_support_8h_a013574543d2f27a210fdfd5fa284ebe3}{CopyMem}}(part.Ident,\ \mbox{\hyperlink{_ne_f_s_8h_aa63173db3f6fc3ff4c5b65e7cdc398b1}{kNeFSIdent}},\ \mbox{\hyperlink{_ne_f_s_8h_a4d5831600df92d8486f9a1d25772ead4}{kNeFSIdentLen}}\ -\/\ 1);}
\DoxyCodeLine{00345\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{_support_8h_a013574543d2f27a210fdfd5fa284ebe3}{CopyMem}}(part.PartitionName,\ part\_name,\ \mbox{\hyperlink{_support_8h_a94a5b7998848651b99c8b45e19c534d7}{StrLen}}(part\_name));}
\DoxyCodeLine{00346\ }
\DoxyCodeLine{00347\ \ \ \ \ \ \ \ \ part.Version\ \ \ \ \ \ =\ \mbox{\hyperlink{_ne_f_s_8h_a61176cf58288663dd7c6cd9e060aa945}{kNeFSVersionInteger}};}
\DoxyCodeLine{00348\ \ \ \ \ \ \ \ \ part.CatalogCount\ =\ blob\_sz\ /\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{struct_n_e_f_s___c_a_t_a_l_o_g___s_t_r_u_c_t}{NEFS\_CATALOG\_STRUCT}});}
\DoxyCodeLine{00349\ \ \ \ \ \ \ \ \ part.Kind\ \ \ \ \ \ \ \ \ =\ BootDev::kSectorSize;}
\DoxyCodeLine{00350\ \ \ \ \ \ \ \ \ part.SectorSize\ \ \ =\ \mbox{\hyperlink{modules_2_a_t_a_2_a_t_a_8h_aed29fb475f84d8a5fdebd6c83e932024}{kATASectorSize}};}
\DoxyCodeLine{00351\ \ \ \ \ \ \ \ \ part.FreeCatalog\ \ =\ fDiskDev.GetSectorsCount()\ /\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{struct_n_e_f_s___c_a_t_a_l_o_g___s_t_r_u_c_t}{NEFS\_CATALOG\_STRUCT}});}
\DoxyCodeLine{00352\ \ \ \ \ \ \ \ \ part.SectorCount\ \ =\ fDiskDev.GetSectorsCount();}
\DoxyCodeLine{00353\ \ \ \ \ \ \ \ \ part.FreeSectors\ \ =\ fDiskDev.GetSectorsCount();}
\DoxyCodeLine{00354\ \ \ \ \ \ \ \ \ part.StartCatalog\ =\ \mbox{\hyperlink{_ne_f_s_8h_a5fe8079384c8a6b4f83adbef1bed84fa}{kNeFSCatalogStartAddress}};}
\DoxyCodeLine{00355\ \ \ \ \ \ \ \ \ part.DiskSize\ \ \ \ \ =\ fDiskDev.GetDiskSize();}
\DoxyCodeLine{00356\ \ \ \ \ \ \ \ \ part.Flags\ \ \ \ \ \ \ \ =\ \mbox{\hyperlink{_ne_f_s_8h_a4b6dd80513d7a502a5568ac9b41ab345}{kNeFSPartitionTypeBoot}}\ |\ \mbox{\hyperlink{_ne_f_s_8h_aeb5912e09d7c47a2a83d21f2f68ceaae}{kNeFSPartitionTypeStandard}};}
\DoxyCodeLine{00357\ }
\DoxyCodeLine{00358\ \ \ \ \ \ \ \ \ fDiskDev.Leak().mBase\ =\ \mbox{\hyperlink{_ne_f_s_8h_af90b1a36da8473bdb033363e9ef27474}{kNeFSRootCatalogStartAddress}};}
\DoxyCodeLine{00359\ \ \ \ \ \ \ \ \ fDiskDev.Leak().mSize\ =\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{struct_n_e_f_s___r_o_o_t___p_a_r_t_i_t_i_o_n___b_l_o_c_k}{NEFS\_ROOT\_PARTITION\_BLOCK}});}
\DoxyCodeLine{00360\ }
\DoxyCodeLine{00361\ \ \ \ \ \ \ \ \ fDiskDev.Write((\mbox{\hyperlink{namespace_ne_o_s_af96b578c23518d339d562bbab4efa72f}{Char}}*)\&part,\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{struct_n_e_f_s___r_o_o_t___p_a_r_t_i_t_i_o_n___b_l_o_c_k}{NEFS\_ROOT\_PARTITION\_BLOCK}}));}
\DoxyCodeLine{00362\ }
\DoxyCodeLine{00363\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_boot_1_1_boot_text_writer}{BootTextWriter}}\ writer;}
\DoxyCodeLine{00364\ }
\DoxyCodeLine{00365\ \ \ \ \ \ \ \ \ writer\ <<\ \textcolor{stringliteral}{"{}BootZ:\ Partition\ name:\ "{}}\ <<\ part.PartitionName\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)r"{}};}
\DoxyCodeLine{00366\ \ \ \ \ \ \ \ \ writer\ <<\ \textcolor{stringliteral}{"{}BootZ:\ Start:\ "{}}\ <<\ part.StartCatalog\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)r"{}};}
\DoxyCodeLine{00367\ \ \ \ \ \ \ \ \ writer\ <<\ \textcolor{stringliteral}{"{}BootZ:\ Number\ of\ catalogs:\ "{}}\ <<\ part.CatalogCount\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)r"{}};}
\DoxyCodeLine{00368\ \ \ \ \ \ \ \ \ writer\ <<\ \textcolor{stringliteral}{"{}BootZ:\ Free\ catalog:\ "{}}\ <<\ part.FreeCatalog\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)r"{}};}
\DoxyCodeLine{00369\ \ \ \ \ \ \ \ \ writer\ <<\ \textcolor{stringliteral}{"{}BootZ:\ Free\ sectors:\ "{}}\ <<\ part.FreeSectors\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)r"{}};}
\DoxyCodeLine{00370\ \ \ \ \ \ \ \ \ writer\ <<\ \textcolor{stringliteral}{"{}BootZ:\ Sector\ size:\ "{}}\ <<\ part.SectorSize\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)r"{}};}
\DoxyCodeLine{00371\ }
\DoxyCodeLine{00372\ \textcolor{preprocessor}{\#ifdef\ BOOTZ\_EPM\_SUPPORT}}
\DoxyCodeLine{00373\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_e_p_m___p_a_r_t___b_l_o_c_k}{EPM\_PART\_BLOCK}}\ epm\_boot\{0\};}
\DoxyCodeLine{00374\ }
\DoxyCodeLine{00375\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\ kFsName\ \ \ \ =\ \textcolor{stringliteral}{"{}NeFS"{}};}
\DoxyCodeLine{00376\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\ kBlockName\ =\ \textcolor{stringliteral}{"{}OS"{}};}
\DoxyCodeLine{00377\ }
\DoxyCodeLine{00378\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{_support_8h_a013574543d2f27a210fdfd5fa284ebe3}{CopyMem}}(epm\_boot.Fs,\ \textcolor{keyword}{reinterpret\_cast<}\mbox{\hyperlink{namespace_ne_o_s_ac1c63bbbae84b587c92428c1f2025036}{VoidPtr}}\textcolor{keyword}{>}(\textcolor{keyword}{const\_cast<}\mbox{\hyperlink{namespace_ne_o_s_af96b578c23518d339d562bbab4efa72f}{Char}}*\textcolor{keyword}{>}(kFsName)),\ \mbox{\hyperlink{_support_8h_a94a5b7998848651b99c8b45e19c534d7}{StrLen}}(kFsName));}
\DoxyCodeLine{00379\ }
\DoxyCodeLine{00380\ \ \ \ \ \ \ \ \ epm\_boot.FsVersion\ =\ \mbox{\hyperlink{_ne_f_s_8h_a61176cf58288663dd7c6cd9e060aa945}{kNeFSVersionInteger}};}
\DoxyCodeLine{00381\ \ \ \ \ \ \ \ \ epm\_boot.LbaStart\ \ =\ \mbox{\hyperlink{_ne_f_s_8h_af90b1a36da8473bdb033363e9ef27474}{kNeFSRootCatalogStartAddress}};}
\DoxyCodeLine{00382\ \ \ \ \ \ \ \ \ epm\_boot.LbaEnd\ \ \ \ =\ fDiskDev.GetDiskSize();}
\DoxyCodeLine{00383\ \ \ \ \ \ \ \ \ epm\_boot.SectorSz\ \ =\ part.SectorSize;}
\DoxyCodeLine{00384\ \ \ \ \ \ \ \ \ epm\_boot.Kind\ \ \ \ \ \ =\ \mbox{\hyperlink{kernel_2_firmware_kit_2_e_p_m_8h_abed82baf7f470b522273a3e37c24c600a7f7e2054fbcb15071a81adea2cfb5ba5}{kEPMNeOS}};}
\DoxyCodeLine{00385\ \ \ \ \ \ \ \ \ epm\_boot.NumBlocks\ =\ part.CatalogCount;}
\DoxyCodeLine{00386\ }
\DoxyCodeLine{00387\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{_support_8h_a013574543d2f27a210fdfd5fa284ebe3}{CopyMem}}(epm\_boot.Name,\ \textcolor{keyword}{reinterpret\_cast<}\mbox{\hyperlink{namespace_ne_o_s_ac1c63bbbae84b587c92428c1f2025036}{VoidPtr}}\textcolor{keyword}{>}(\textcolor{keyword}{const\_cast<}\mbox{\hyperlink{namespace_ne_o_s_af96b578c23518d339d562bbab4efa72f}{Char}}*\textcolor{keyword}{>}(kBlockName)),\ \mbox{\hyperlink{_support_8h_a94a5b7998848651b99c8b45e19c534d7}{StrLen}}(kBlockName));}
\DoxyCodeLine{00388\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{_support_8h_a013574543d2f27a210fdfd5fa284ebe3}{CopyMem}}(epm\_boot.Magic,\ \textcolor{keyword}{reinterpret\_cast<}\mbox{\hyperlink{namespace_ne_o_s_ac1c63bbbae84b587c92428c1f2025036}{VoidPtr}}\textcolor{keyword}{>}(\textcolor{keyword}{const\_cast<}\mbox{\hyperlink{namespace_ne_o_s_af96b578c23518d339d562bbab4efa72f}{Char}}*\textcolor{keyword}{>}(\mbox{\hyperlink{kernel_2_firmware_kit_2_e_p_m_8h_ab80664c8631dacf12102260c3d986f27}{kEPMMagic}})),\ \mbox{\hyperlink{_support_8h_a94a5b7998848651b99c8b45e19c534d7}{StrLen}}(\mbox{\hyperlink{kernel_2_firmware_kit_2_e_p_m_8h_ab80664c8631dacf12102260c3d986f27}{kEPMMagic}}));}
\DoxyCodeLine{00389\ }
\DoxyCodeLine{00390\ \ \ \ \ \ \ \ \ fDiskDev.Leak().mBase\ =\ \mbox{\hyperlink{kernel_2_firmware_kit_2_e_p_m_8h_ae1907cf593bdc3ccdb2dce3892982f98}{kEPMBootBlockLba}};\ \textcolor{comment}{//\ always\ always\ resies\ at\ zero\ block.}}
\DoxyCodeLine{00391\ \ \ \ \ \ \ \ \ fDiskDev.Leak().mSize\ =\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{struct_e_p_m___p_a_r_t___b_l_o_c_k}{EPM\_PART\_BLOCK}});}
\DoxyCodeLine{00392\ }
\DoxyCodeLine{00393\ \ \ \ \ \ \ \ \ fDiskDev.Write((\mbox{\hyperlink{namespace_ne_o_s_af96b578c23518d339d562bbab4efa72f}{Char}}*)\&epm\_boot,\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{struct_e_p_m___p_a_r_t___b_l_o_c_k}{EPM\_PART\_BLOCK}}));}
\DoxyCodeLine{00394\ }
\DoxyCodeLine{00395\ \ \ \ \ \ \ \ \ writer.\mbox{\hyperlink{class_boot_1_1_boot_text_writer_ab6ced6c2de790ef1f6399e6446011ed4}{Write}}(L\textcolor{stringliteral}{"{}BootZ:\ Drive\ has\ been\ formatted\ Successfully.\(\backslash\)r"{}});}
\DoxyCodeLine{00396\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00397\ }
\DoxyCodeLine{00398\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{ddk_8h_a7ebc9a785e5ab85457c98595aac81589}{YES}};}
\DoxyCodeLine{00399\ \ \ \ \ \}}
\DoxyCodeLine{00400\ \}\ \textcolor{comment}{//\ namespace\ Boot}}

\end{DoxyCode}
