\doxysection{PEF.\+h}
\hypertarget{_p_e_f_8h_source}{}\label{_p_e_f_8h_source}\index{dev/kernel/KernelKit/PEF.h@{dev/kernel/KernelKit/PEF.h}}
\mbox{\hyperlink{_p_e_f_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{/*\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00002\ \textcolor{comment}{}}
\DoxyCodeLine{00003\ \textcolor{comment}{\ \ \ \ Copyright\ (C)\ 2024-\/2025,\ Amlal\ EL\ Mahrouss,\ all\ rights\ reserved.}}
\DoxyCodeLine{00004\ \textcolor{comment}{}}
\DoxyCodeLine{00005\ \textcolor{comment}{\ \ \ \ File:\ PEF.h}}
\DoxyCodeLine{00006\ \textcolor{comment}{\ \ \ \ Purpose:\ Preferred\ Executable\ Format\ for\ Kernel.}}
\DoxyCodeLine{00007\ \textcolor{comment}{}}
\DoxyCodeLine{00008\ \textcolor{comment}{\ \ \ \ Revision\ History:}}
\DoxyCodeLine{00009\ \textcolor{comment}{}}
\DoxyCodeLine{00010\ \textcolor{comment}{\ \ \ \ ?/?/23:\ Added\ file\ (amlel)}}
\DoxyCodeLine{00011\ \textcolor{comment}{}}
\DoxyCodeLine{00012\ \textcolor{comment}{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/\ */}}
\DoxyCodeLine{00013\ }
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#ifndef\ KERNELKIT\_PEF\_H}}
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#define\ KERNELKIT\_PEF\_H}}
\DoxyCodeLine{00016\ }
\DoxyCodeLine{00017\ \textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{_compiler_kit_8h}{CompilerKit/CompilerKit.h}}>}}
\DoxyCodeLine{00018\ \textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{_loader_interface_8h}{KernelKit/LoaderInterface.h}}>}}
\DoxyCodeLine{00019\ \textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{kernel_2_new_kit_2_defines_8h}{NewKit/Defines.h}}>}}
\DoxyCodeLine{00020\ }
\DoxyCodeLine{00021\ \textcolor{preprocessor}{\#define\ kPefMagic\ \ \ \ "{}Joy!"{}}}
\DoxyCodeLine{00022\ \textcolor{preprocessor}{\#define\ kPefMagicFat\ "{}yoJ!"{}}}
\DoxyCodeLine{00023\ }
\DoxyCodeLine{00024\ \textcolor{preprocessor}{\#define\ kPefMagicLen\ 5}}
\DoxyCodeLine{00025\ }
\DoxyCodeLine{00026\ \textcolor{preprocessor}{\#define\ kPefVersion\ 3}}
\DoxyCodeLine{00027\ \textcolor{preprocessor}{\#define\ kPefNameLen\ 256U}}
\DoxyCodeLine{00028\ }
\DoxyCodeLine{00029\ \textcolor{comment}{/*\ not\ mandatory,\ only\ for\ non\ fork\ based\ filesystems.\ */}}
\DoxyCodeLine{00030\ \textcolor{preprocessor}{\#define\ kPefExt\ \ \ \ \ \ \ "{}.o"{}}}
\DoxyCodeLine{00031\ \textcolor{preprocessor}{\#define\ kPefDylibExt\ \ "{}.dylib"{}}}
\DoxyCodeLine{00032\ \textcolor{preprocessor}{\#define\ kPefLibExt\ \ \ \ "{}.lib"{}}}
\DoxyCodeLine{00033\ \textcolor{preprocessor}{\#define\ kPefObjectExt\ "{}.obj"{}}}
\DoxyCodeLine{00034\ \textcolor{preprocessor}{\#define\ kPefDebugExt\ \ "{}.dbg"{}}}
\DoxyCodeLine{00035\ \textcolor{preprocessor}{\#define\ kPefDriverExt\ "{}.sys"{}}}
\DoxyCodeLine{00036\ }
\DoxyCodeLine{00037\ \textcolor{comment}{//\ Kernel\ System\ Binary\ Interface.}}
\DoxyCodeLine{00038\ \textcolor{preprocessor}{\#define\ kPefAbi\ (0x5046)}}
\DoxyCodeLine{00039\ }
\DoxyCodeLine{00040\ \textcolor{preprocessor}{\#define\ kPefBaseOrigin\ (0x40000000)}}
\DoxyCodeLine{00041\ }
\DoxyCodeLine{00042\ \textcolor{preprocessor}{\#define\ kPefStart\ "{}\_\_ImageStart"{}}}
\DoxyCodeLine{00043\ }
\DoxyCodeLine{00044\ \textcolor{preprocessor}{\#define\ kPefForkKind\ \ \ \ kPefMagic}}
\DoxyCodeLine{00045\ \textcolor{preprocessor}{\#define\ kPefForkKindFAT\ kPefMagicFat}}
\DoxyCodeLine{00046\ }
\DoxyCodeLine{00047\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespace_ne_o_s}{NeOS}}}
\DoxyCodeLine{00048\ \{}
\DoxyCodeLine{00049\ \ \ \ \ \textcolor{keyword}{enum}}
\DoxyCodeLine{00050\ \ \ \ \ \{}
\DoxyCodeLine{00051\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_ne_o_s_a607f5f63b1b8d53d1378d975eda052f6a56cfb644b94d24f5476f9326224e9566}{kPefArchIntel86S}},}
\DoxyCodeLine{00052\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_ne_o_s_a607f5f63b1b8d53d1378d975eda052f6a5e5472a67cb67a4dcae202b8a92ed7f5}{kPefArchAMD64}},}
\DoxyCodeLine{00053\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_ne_o_s_a607f5f63b1b8d53d1378d975eda052f6acb1b411b7077a941ccc94a0ea77fed8f}{kPefArchRISCV}},}
\DoxyCodeLine{00054\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_ne_o_s_a607f5f63b1b8d53d1378d975eda052f6a75396b1eeff967a7da155f47f25f6338}{kPefArch64x0}},\ \textcolor{comment}{/*\ 64x0.\ ISA\ */}}
\DoxyCodeLine{00055\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_ne_o_s_a607f5f63b1b8d53d1378d975eda052f6a067d8a546ff0634ad0e751eb61fa6e3f}{kPefArch32x0}},\ \textcolor{comment}{/*\ 32x0.\ ISA\ */}}
\DoxyCodeLine{00056\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_ne_o_s_a607f5f63b1b8d53d1378d975eda052f6a49ef3eed1170961843113bd3bc7cfe59}{kPefArchPowerPC}},}
\DoxyCodeLine{00057\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_ne_o_s_a607f5f63b1b8d53d1378d975eda052f6a9f425fb2decfe96b8ac98025bcd4497d}{kPefArchARM64}},}
\DoxyCodeLine{00058\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_ne_o_s_a607f5f63b1b8d53d1378d975eda052f6acbf9ad91646dbb5fbf2a36f1899598c1}{kPefArchCount}}\ \ =\ (\mbox{\hyperlink{namespace_ne_o_s_a607f5f63b1b8d53d1378d975eda052f6a49ef3eed1170961843113bd3bc7cfe59}{kPefArchPowerPC}}\ -\/\ \mbox{\hyperlink{namespace_ne_o_s_a607f5f63b1b8d53d1378d975eda052f6a56cfb644b94d24f5476f9326224e9566}{kPefArchIntel86S}})\ +\ 1,}
\DoxyCodeLine{00059\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_ne_o_s_a607f5f63b1b8d53d1378d975eda052f6ae11865af6447f8371bd2f0ce8cff6a8a}{kPefArchInvalid}}\ =\ 0xFF,}
\DoxyCodeLine{00060\ \ \ \ \ \};}
\DoxyCodeLine{00061\ }
\DoxyCodeLine{00062\ \ \ \ \ \textcolor{keyword}{enum}}
\DoxyCodeLine{00063\ \ \ \ \ \{}
\DoxyCodeLine{00064\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_ne_o_s_a8778744b0e5802d96f2d042e15ce4d01afa1fbc69c91122062da198cf8a4d273e}{kPefSubArchAMD}},}
\DoxyCodeLine{00065\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_ne_o_s_a8778744b0e5802d96f2d042e15ce4d01ae604cd6845b0f2fbbad783606235feeb}{kPefSubArchIntel}},}
\DoxyCodeLine{00066\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_ne_o_s_a8778744b0e5802d96f2d042e15ce4d01ae1779ae3874cdb68c62d14fa1fc139fa}{kPefSubArchARM}},}
\DoxyCodeLine{00067\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_ne_o_s_a8778744b0e5802d96f2d042e15ce4d01a6f56d9a108287b56bb1de71451810bc1}{kPefSubArchGeneric}},}
\DoxyCodeLine{00068\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_ne_o_s_a8778744b0e5802d96f2d042e15ce4d01adb5644a145d088a236c4e6f8bf95c858}{kPefSubArchIBM}},}
\DoxyCodeLine{00069\ \ \ \ \ \};}
\DoxyCodeLine{00070\ }
\DoxyCodeLine{00071\ \ \ \ \ \textcolor{keyword}{enum}}
\DoxyCodeLine{00072\ \ \ \ \ \{}
\DoxyCodeLine{00073\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_ne_o_s_ab5922a441638d2e46135d9b56c82b970a4934701f2d68e4b7b847dddc1d1a53a5}{kPefKindExec}}\ \ \ =\ 1,\ \textcolor{comment}{/*\ .o\ */}}
\DoxyCodeLine{00074\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_ne_o_s_ab5922a441638d2e46135d9b56c82b970aa9f63402bedab72ef5614f4df303f5a8}{kPefKindDylib}}\ \ =\ 2,\ \textcolor{comment}{/*\ .dylib\ */}}
\DoxyCodeLine{00075\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_ne_o_s_ab5922a441638d2e46135d9b56c82b970a58b3cfc00aae468d9472d02fc420c0b6}{kPefKindObject}}\ =\ 4,\ \textcolor{comment}{/*\ .obj\ */}}
\DoxyCodeLine{00076\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_ne_o_s_ab5922a441638d2e46135d9b56c82b970a85ad6cc16d8f30367bff6195f12ff163}{kPefKindDebug}}\ \ =\ 5,\ \textcolor{comment}{/*\ .dbg\ */}}
\DoxyCodeLine{00077\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_ne_o_s_ab5922a441638d2e46135d9b56c82b970a73825ae90290481b6baa79dd8a461fc2}{kPefKindDriver}}\ =\ 6,}
\DoxyCodeLine{00078\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_ne_o_s_ab5922a441638d2e46135d9b56c82b970a2c6c166847b10bbf5483f017226bed2a}{kPefKindCount}},}
\DoxyCodeLine{00079\ \ \ \ \ \};}
\DoxyCodeLine{00080\ }
\DoxyCodeLine{00081\ \ \ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_ne_o_s_1_1_p_e_f_container}{PEFContainer}}\ final}
\DoxyCodeLine{00082\ \ \ \ \ \{}
\DoxyCodeLine{00083\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_ne_o_s_af96b578c23518d339d562bbab4efa72f}{Char}}\ \ \ \ \mbox{\hyperlink{struct_ne_o_s_1_1_p_e_f_container_a75d9685f0b7ed4d9947c466622fe1354}{Magic}}[\mbox{\hyperlink{_p_e_f_8h_ac9750b18a6818b8c9d5fb229e0417c5d}{kPefMagicLen}}];}
\DoxyCodeLine{00084\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_ne_o_s_a160d206409956603d46f6292a41b1f52}{UInt32}}\ \ \ \ \mbox{\hyperlink{struct_ne_o_s_1_1_p_e_f_container_a9fa96c62ef56bd0f78108b5f0aac19a5}{Linker}};}
\DoxyCodeLine{00085\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_ne_o_s_a160d206409956603d46f6292a41b1f52}{UInt32}}\ \ \ \ \mbox{\hyperlink{struct_ne_o_s_1_1_p_e_f_container_ab67bef52489743881177c50d3d10db8b}{Version}};}
\DoxyCodeLine{00086\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_ne_o_s_a160d206409956603d46f6292a41b1f52}{UInt32}}\ \ \ \ \mbox{\hyperlink{struct_ne_o_s_1_1_p_e_f_container_a5f81b462ec8b6be43877cbc0aece2b13}{Kind}};}
\DoxyCodeLine{00087\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_ne_o_s_a160d206409956603d46f6292a41b1f52}{UInt32}}\ \ \ \ \mbox{\hyperlink{struct_ne_o_s_1_1_p_e_f_container_ae4375d14cab22740ded8ad16b5935411}{Abi}};}
\DoxyCodeLine{00088\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_ne_o_s_a160d206409956603d46f6292a41b1f52}{UInt32}}\ \ \ \ \mbox{\hyperlink{struct_ne_o_s_1_1_p_e_f_container_aa392a518a9dc8e153f64eee06d272ade}{Cpu}};}
\DoxyCodeLine{00089\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_ne_o_s_a160d206409956603d46f6292a41b1f52}{UInt32}}\ \ \ \ \mbox{\hyperlink{struct_ne_o_s_1_1_p_e_f_container_a6b9d1296083de3409f7b7fe547b5a3f6}{SubCpu}};\ \textcolor{comment}{/*\ Cpu\ specific\ information\ */}}
\DoxyCodeLine{00090\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_ne_o_s_a45d30b4091e6c91b5e25bcf408ca6dbb}{UIntPtr}}\ \mbox{\hyperlink{struct_ne_o_s_1_1_p_e_f_container_a61b12f6b972edb1145d16540c8ff5c95}{Start}};}
\DoxyCodeLine{00091\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_ne_o_s_a5bbd9eec89d9fb8e95178b14ce2fcafc}{SizeT}}\ \ \mbox{\hyperlink{struct_ne_o_s_1_1_p_e_f_container_a0b90a2ba6d2ff3fae06e18b79061a382}{HdrSz}};\ \textcolor{comment}{/*\ Size\ of\ header\ */}}
\DoxyCodeLine{00092\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_ne_o_s_a5bbd9eec89d9fb8e95178b14ce2fcafc}{SizeT}}\ \ \mbox{\hyperlink{struct_ne_o_s_1_1_p_e_f_container_af7619e0f22ec5907106b313a65cc7018}{Count}};\ \textcolor{comment}{/*\ container\ header\ count\ */}}
\DoxyCodeLine{00093\ \ \ \ \ \}\ \mbox{\hyperlink{kernel_2_new_kit_2_macros_8h_a36d525cf4d116b2fe4ecc00222b256f1}{PACKED}}\ PEFContainer;}
\DoxyCodeLine{00094\ }
\DoxyCodeLine{00095\ \ \ \ \ \textcolor{comment}{/*\ First\ PEFCommandHeader\ starts\ after\ PEFContainer\ */}}
\DoxyCodeLine{00096\ }
\DoxyCodeLine{00097\ \ \ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_ne_o_s_1_1_p_e_f_command_header}{PEFCommandHeader}}\ final}
\DoxyCodeLine{00098\ \ \ \ \ \{}
\DoxyCodeLine{00099\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_ne_o_s_af96b578c23518d339d562bbab4efa72f}{Char}}\ \ \ \ \mbox{\hyperlink{struct_ne_o_s_1_1_p_e_f_command_header_a0a52b3cccaeaf859b5770d40d7b59eac}{Name}}[\mbox{\hyperlink{_p_e_f_8h_acfba2dc9def360cf0ca9fb0d3cc875ea}{kPefNameLen}}];\ \textcolor{comment}{/*\ container\ name\ */}}
\DoxyCodeLine{00100\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_ne_o_s_a160d206409956603d46f6292a41b1f52}{UInt32}}\ \ \ \ \mbox{\hyperlink{struct_ne_o_s_1_1_p_e_f_command_header_a8efb588b65c65618a2fda4c41551fb13}{Cpu}};\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ container\ cpu\ */}}
\DoxyCodeLine{00101\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_ne_o_s_a160d206409956603d46f6292a41b1f52}{UInt32}}\ \ \ \ \mbox{\hyperlink{struct_ne_o_s_1_1_p_e_f_command_header_a53af9870d056af359c7725c2b37df880}{SubCpu}};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ container\ sub-\/cpu\ */}}
\DoxyCodeLine{00102\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_ne_o_s_a160d206409956603d46f6292a41b1f52}{UInt32}}\ \ \ \ \mbox{\hyperlink{struct_ne_o_s_1_1_p_e_f_command_header_a00d6fc7d55e1ed0b1ea892c866f8249b}{Flags}};\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ container\ flags\ */}}
\DoxyCodeLine{00103\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_ne_o_s_a4885ae005fc56130691bdea86d9a88d7}{UInt16}}\ \ \ \ \mbox{\hyperlink{struct_ne_o_s_1_1_p_e_f_command_header_a3af35b5d5f9492f733066b240547b7a5}{Kind}};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ container\ kind\ */}}
\DoxyCodeLine{00104\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_ne_o_s_a45d30b4091e6c91b5e25bcf408ca6dbb}{UIntPtr}}\ \mbox{\hyperlink{struct_ne_o_s_1_1_p_e_f_command_header_a762e59e3b1c15b1d948921ae49f05066}{Offset}};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ content\ offset\ */}}
\DoxyCodeLine{00105\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_ne_o_s_a5bbd9eec89d9fb8e95178b14ce2fcafc}{SizeT}}\ \ \mbox{\hyperlink{struct_ne_o_s_1_1_p_e_f_command_header_aa9dd483ee9bc9c4775a931848158b539}{Size}};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ content\ Size\ */}}
\DoxyCodeLine{00106\ \ \ \ \ \}\ \mbox{\hyperlink{kernel_2_new_kit_2_macros_8h_a36d525cf4d116b2fe4ecc00222b256f1}{PACKED}}\ PEFCommandHeader;}
\DoxyCodeLine{00107\ }
\DoxyCodeLine{00108\ \ \ \ \ \textcolor{keyword}{enum}}
\DoxyCodeLine{00109\ \ \ \ \ \{}
\DoxyCodeLine{00110\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_ne_o_s_a695354c34a79bc19d87bd6d6ddf6dc2ea232b46ab43e20f62b0730bde27d1fcd9}{kPefCode}}\ \ \ \ \ =\ 0xC,}
\DoxyCodeLine{00111\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_ne_o_s_a695354c34a79bc19d87bd6d6ddf6dc2ea4a96265d6b535cf126d68a2c30c51401}{kPefData}}\ \ \ \ \ =\ 0xD,}
\DoxyCodeLine{00112\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_ne_o_s_a695354c34a79bc19d87bd6d6ddf6dc2ea334b823591a612f8d59e4c711d015686}{kPefZero}}\ \ \ \ \ =\ 0xE,}
\DoxyCodeLine{00113\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_ne_o_s_a695354c34a79bc19d87bd6d6ddf6dc2ea13b1a66fec8121d65b399cdc8fc021ba}{kPefLinkerID}}\ =\ 0x1,}
\DoxyCodeLine{00114\ \ \ \ \ \};}
\DoxyCodeLine{00115\ \}\ \textcolor{comment}{//\ namespace\ NeOS}}
\DoxyCodeLine{00116\ }
\DoxyCodeLine{00117\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{/*\ ifndef\ KERNELKIT\_PEF\_H\ */}\textcolor{preprocessor}{}}

\end{DoxyCode}
